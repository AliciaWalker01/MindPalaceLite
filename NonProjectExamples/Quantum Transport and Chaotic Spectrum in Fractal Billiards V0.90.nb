(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    202882,       4881]
NotebookOptionsPosition[    198305,       4805]
NotebookOutlinePosition[    198689,       4821]
CellTagsIndexPosition[    198646,       4818]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Quantum Mechanics of Fractal Billiards V0.9", "Title",
 CellChangeTimes->{{3.7335918036401324`*^9, 3.7335918308410234`*^9}, {
   3.733763540788516*^9, 3.7337635432525897`*^9}, 3.73597367094493*^9, 
   3.7359738375719495`*^9},ExpressionUUID->"aab7f7e7-f586-4645-bcaa-\
4d6482fc51a9"],

Cell[CellGroupData[{

Cell["Core Dependencies", "Section",
 CellChangeTimes->{{3.7335918511415997`*^9, 
  3.7335918640412464`*^9}},ExpressionUUID->"2e9a604f-b5ad-4b4d-99ae-\
08f3adb58abf"],

Cell["\<\
These are functions which are core to the simulation. The functions create \
sets of fractal points, calculate the Laplacian as a form of a matrix to be \
applied to our state vectors.
These also have some functions to calculate the eigenstates in a zero \
potential using symmetry arguments (using the Variational Principle). We aim \
to construct our Sierpinski Carpet centred around an 
Origin set at (0,0). The Laplacian Matrix is a key matrix, as will be \
Potential functions which produce their own (Diagonal) Matrix for further \
time simulation. \
\>", "Text",
 CellChangeTimes->{{3.733752446877289*^9, 
  3.7337526917728357`*^9}},ExpressionUUID->"dc07cbbf-84cc-4c0e-ad08-\
3c2f2d611110"],

Cell[CellGroupData[{

Cell["1. Carpet Generator", "Subsubsection",
 CellChangeTimes->{{3.7337633345655947`*^9, 
  3.733763362659541*^9}},ExpressionUUID->"00440248-e6f5-4915-8bb8-\
d489ea89a9a9"],

Cell["\<\
This creates a set of fractal coordinates that are the removed regions of the \
S\[IAcute]erpinski Carpet, centred on an origin of (0,0) with integer \
iteration f and precision g.\
\>", "Text",
 CellChangeTimes->{{3.7337634787568254`*^9, 3.7337635141964197`*^9}, {
  3.7337635532039137`*^9, 
  3.7337635815887775`*^9}},ExpressionUUID->"51d2a2a2-5c37-4669-83b4-\
f57327c36e52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fractalGeneration", "[", 
   RowBox[{"f_", ",", "g_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "localcoordlist", ",", "outputindexlist", ",", 
      "localsinglecoordinatelist", ",", "localvarn", ",", "test", ",", 
      "construction", ",", "a", ",", "b", ",", "c", ",", "d", ",", 
      "tempconstruction", ",", "tempb", ",", "tempb2", ",", "intsteps", ",", 
      "i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"localvarn", "=", 
      RowBox[{
       RowBox[{"3", "^", "f"}], "*", "g"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"localsinglecoordinatelist", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"-", "localvarn"}], ",", "localvarn"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"test", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "localvarn"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"This", " ", "is", " ", "a", " ", "hack"}], ",", " ", 
       RowBox[{
       "since", " ", "the", " ", "centre", " ", "point", " ", "is", " ", 
        "centred", " ", "on", " ", "a", " ", "zero", " ", "point", " ", 
        "then", " ", "setting", " ", "zero", " ", "allows", " ", "this", " ", 
        "variable", " ", "to", " ", "be", " ", "used"}]}], "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"d", " ", "=", " ", 
      RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"construction", " ", "=", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "This", " ", "loop", " ", "cycles", " ", "through", " ", "each", " ", 
        "iteration", " ", "finding", " ", "the", " ", "values", " ", "of", 
        " ", "1", "D", " ", "coordinates", " ", "where", " ", "the", " ", 
        "central", " ", "square", " ", "in", " ", "that", 
        "\[IndentingNewLine]", "\t", "order", " ", "is", " ", "removed"}], 
       ",", " ", 
       RowBox[{
       "it", " ", "then", " ", "works", " ", "out", " ", "based", " ", "on", 
        " ", "the", " ", "number", " ", "of", " ", "squares", " ", 
        "generated", " ", "for", " ", "each", " ", "iteration", " ", "the", 
        " ", "coordinates", " ", "for", "\[IndentingNewLine]", "\t", "all", 
        " ", "other", " ", "squares", " ", "in", " ", "1", "D", " ", "and", 
        " ", "combines", " ", "them", " ", "together", " ", "in", " ", 
        "union"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", "f"}], ",", 
       RowBox[{"i", "++"}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"localvarn", "/", 
          RowBox[{"3", "^", "i"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"b", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "a"}], ",", "a"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"c", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"localvarn", "-", 
            RowBox[{"localvarn", "/", "3"}]}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "3"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"i", "-", "2"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"intsteps", " ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "^", 
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}]}], "-", "1"}], ")"}], "/", 
          "2"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"d", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"b", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "        ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "we", " ", "can", " ", "take", " ", "our", " ", "1", 
           "D", " ", "list", " ", "of", " ", "coordinates", " ", "and", " ", 
           "produce", " ", "a", " ", "2", "D", " ", "set", " ", "of", " ", 
           "coordinate", " ", "with", " ", "all", " ", "the", " ", 
           "permutations", " ", "of", " ", 
           RowBox[{"them", ".", " ", "We"}], " ", "start", " ", "off", " ", 
           "with", " ", "\n", "         ", "the", " ", "simple", " ", "1", 
           "st", " ", "order", " ", "square"}], ",", " ", 
          RowBox[{
          "then", " ", "we", " ", "find", " ", "the", " ", "other", " ", 
           "sets", " ", "of", " ", "squares", " ", "and", " ", "find", " ", 
           "their", " ", "central", " ", "point"}], ",", " ", "\n", 
          "         ", 
          RowBox[{
          "then", " ", "their", " ", "1", "D", " ", "list", " ", "of", " ", 
           "coordinates"}], ",", " ", 
          RowBox[{
          "then", " ", "all", " ", "permutations", " ", "and", " ", "add", 
           " ", "these", " ", "to", " ", "those", " ", "of", " ", "the", " ", 
           "lower", " ", "order", " ", "terms"}]}], "*)"}], "\n", "         ",
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{"tempconstruction", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"b", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"construction", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"tempconstruction", ",", "construction"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
         "define", " ", "temp", " ", "forwards", " ", "and", " ", "backwards",
           " ", "cases"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"tempb", "=", "b"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"tempb2", "=", "b"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "0"}], ",", 
          RowBox[{"j", "<", " ", "intsteps"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"tempb", "=", " ", 
            RowBox[{"tempb", "+", "c"}]}], ";", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"tempb2", "=", 
            RowBox[{"tempb2", "-", "c"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"b", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"b", ",", "tempb", ",", "tempb2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"d", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"d", ",", "b"}], "]"}]}], ";", "\n", "\t\t\t", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"tempconstruction", "=", 
            RowBox[{"Tuples", "[", 
             RowBox[{"b", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"construction", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"tempconstruction", ",", "construction"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "construction"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.7337633695626802`*^9, 3.7337634542324734`*^9}, {
  3.7592678862940207`*^9, 
  3.7592681565021224`*^9}},ExpressionUUID->"0bc09b9d-58e9-4a5b-8462-\
e3b492341599"],

Cell["\<\
This creates sets of fractal coordinates that instead emanate from (0,0) but \
includes cases that do not require a centre point [Credit due to Miguel for \
finding this]\
\>", "Text",
 CellChangeTimes->{{3.7337636035715156`*^9, 
  3.733763646789012*^9}},ExpressionUUID->"ecc8ab1d-d56a-4c17-95db-\
a996317d3f1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Laplacian", " ", "Operator", " ", "Matrix", " ", 
    RowBox[{"Construction", ":"}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"fractalcoordinates", "[", 
     RowBox[{"iteration_", ",", "precision_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"endpoint", " ", "=", " ", 
         RowBox[{"precision", "*", 
          RowBox[{"3", "^", "iteration"}]}]}], ",", " ", "output"}], "}"}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"output", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{"x", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"(", 
                    RowBox[{"step", "+", " ", 
                    RowBox[{"endpoint", "/", 
                    RowBox[{"3", "^", "m"}]}]}], ")"}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"(", " ", 
                    RowBox[{"endpoint", "/", 
                    RowBox[{"3", "^", "m"}]}], ")"}]}], "+", "step"}], ",", 
                    "1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"step", ",", "0", ",", 
                   RowBox[{"endpoint", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"3", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m"}], ")"}]}]}], ")"}]}], ",", 
                   RowBox[{"precision", "*", 
                    RowBox[{"3", "^", 
                    RowBox[{"(", 
                    RowBox[{"iteration", "+", "1", "-", "m"}], ")"}]}]}]}], 
                  "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "1", ",", "iteration"}], "}"}]}], "]"}], ",", 
          "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\n", 
   RowBox[{
    RowBox[{"fractalcoordinates2", "[", 
     RowBox[{"iteration_", ",", "precision_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"endpoint", " ", "=", " ", 
         RowBox[{"precision", "*", 
          RowBox[{"3", "^", "iteration"}]}]}], ",", " ", "output"}], "}"}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"iteration", " ", "\[Equal]", " ", "0"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"output", " ", "=", " ", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"ParallelTable", "[", 
             RowBox[{
              RowBox[{"Tuples", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"x", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"(", 
                    RowBox[{"step", "+", " ", 
                    RowBox[{"endpoint", "/", 
                    RowBox[{"3", "^", "m"}]}]}], ")"}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"(", " ", 
                    RowBox[{"endpoint", "/", 
                    RowBox[{"3", "^", "m"}]}], ")"}]}], "+", "step"}], ",", 
                    "1"}], "}"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"step", ",", "0", ",", 
                    RowBox[{"endpoint", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"3", "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "m"}], ")"}]}]}], ")"}]}], ",", 
                    RowBox[{"precision", "*", 
                    RowBox[{"3", "^", 
                    RowBox[{"(", 
                    RowBox[{"iteration", "+", "1", "-", "m"}], ")"}]}]}]}], 
                    "}"}]}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "1", ",", "iteration"}], "}"}]}], "]"}], ",",
             "1"}], "]"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
    "\n"}]}]], "Code",
 CellChangeTimes->{{3.7335918722337937`*^9, 3.7335919106777267`*^9}, {
   3.7335920669395494`*^9, 3.733592070644052*^9}, {3.7335922516583967`*^9, 
   3.7335922558929873`*^9}, {3.7337507823359175`*^9, 3.733750782581448*^9}, {
   3.7337636682339997`*^9, 3.7337636687939186`*^9}, {3.7337648138689084`*^9, 
   3.7337648171779585`*^9}, 3.7337650543315215`*^9, {3.7337651967279053`*^9, 
   3.733765198103292*^9}, 3.7337652388400044`*^9, {3.733765343128479*^9, 
   3.7337653920888486`*^9}, {3.733765455337414*^9, 3.733765475641037*^9}, {
   3.73376551887355*^9, 3.733765687753167*^9}, {3.7337657586110144`*^9, 
   3.733765775526546*^9}, 3.759268128677025*^9, 
   3.759268163812478*^9},ExpressionUUID->"f511c3cf-eaf5-48ac-84dd-\
8c6bcd35a2c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2. Laplacian / 0-Potential Hamiltonian Operator Matrix Construction\
\>", "Subsubsection",
 CellChangeTimes->{{3.7337636846770306`*^9, 
  3.733763719635994*^9}},ExpressionUUID->"18c9c9a5-5541-476b-bb85-\
39af4780b555"],

Cell[TextData[{
 "The Laplacian Operator is ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Del]", "2"], TraditionalForm]],ExpressionUUID->
  "d4aab2cc-6e8e-4af8-a76c-14f839f894da"],
 " = ",
 Cell[BoxData[
  FormBox[
   FractionBox["1", 
    RowBox[{"2", 
     SuperscriptBox["\[Delta]", "2"]}]], TraditionalForm]],ExpressionUUID->
  "f6ef088c-e2bf-41f1-828d-03838b41039e"],
 "(-4",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", 
    RowBox[{"i", ",", "j"}]], TraditionalForm]],ExpressionUUID->
  "2ad8c8c7-2aae-4b51-aab6-486eaa2114ff"],
 " + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", 
    RowBox[{
     RowBox[{"i", "+", "1"}], ",", "j"}]], TraditionalForm]],ExpressionUUID->
  "4a5bb632-2da8-4e70-b7a0-e534399ed6b6"],
 " + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", 
    RowBox[{
     RowBox[{"i", "-", "1"}], ",", "j"}]], TraditionalForm]],ExpressionUUID->
  "c4b5e7d5-7cc4-45ba-a061-6f33688711b0"],
 " + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", 
    RowBox[{"i", ",", 
     RowBox[{"j", "-", "1"}]}]], TraditionalForm]],ExpressionUUID->
  "813e0894-727f-4392-a52f-65b1e2f7c998"],
 " +",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", 
    RowBox[{"i", ",", 
     RowBox[{"j", "+", "1"}]}]], TraditionalForm]],ExpressionUUID->
  "e2451823-b5f4-4298-8ae3-76e654f5ac51"],
 ")+ O( ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Delta]", "4"], TraditionalForm]],ExpressionUUID->
  "7b21ff9b-ccfc-4498-b6a7-1af2630ab1ab"],
 " ) . In order to do this, we use Sparse Matrix Methods, rather than use \
pure tables for considerable performance gains. To use this method we must be \
able to list exactly which values all of the specific entries should take. \
The below functions check for the adjacent coordinates for each point in our \
space and then output a list of which the main function will set to -1. For \
constructing a 0-Potential Hamiltonian using Symmetry grounds, we use the \
variational Principle and have an additional function to use as below it."
}], "Text",
 CellChangeTimes->{{3.7337637357011003`*^9, 3.733763878915887*^9}, {
  3.7337641204549427`*^9, 3.7337641267722487`*^9}, {3.7337642692427893`*^9, 
  3.7337645080859585`*^9}, {3.7337645404050922`*^9, 3.7337646796223464`*^9}, {
  3.733764894487032*^9, 3.733764923000786*^9}, {3.733764970029935*^9, 
  3.73376497395899*^9}, {3.733934807880983*^9, 
  3.7339348269369698`*^9}},ExpressionUUID->"46f2368c-9e8e-449f-8f4e-\
9db1b28125bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Adjacent", " ", "Coordinates"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"isInside5", "[", 
     RowBox[{"i_", ",", "coordlist_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coord", "=", 
         RowBox[{"Part", "[", 
          RowBox[{"coordlist", ",", "i"}], "]"}]}], ",", " ", "output", ",", 
        "a", ",", "length4", ",", "itab"}], "}"}], ",", "\[IndentingNewLine]",
       "\t", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"List", "[", 
         RowBox[{
          RowBox[{"coord", "+", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ",", 
          RowBox[{"coord", "-", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ",", 
          RowBox[{"coord", "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", 
          RowBox[{"coord", "-", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"output", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{"a", ",", "coordlist"}], "]"}]}], ";", "\[IndentingNewLine]",
        "\t", 
       RowBox[{"length4", "=", 
        RowBox[{"Length", "[", "output", "]"}]}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"itab", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "length4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"output", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{"coordlist", ",", 
                RowBox[{"output", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "output", "]"}]}], "}"}]}], "]"}], ",", 
          "i", ",", "itab"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Coordinates", " ", "along", " ", "a", " ", "parity", " ", "axis", " ", 
     "according", " ", "to", " ", "variational", " ", 
     RowBox[{"Principle", " ", "[", 
      RowBox[{
      "Credit", " ", "is", " ", "due", " ", "to", " ", "Miguel", " ", "for", 
       " ", "this"}], "]"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"isinaxis2", "[", 
     RowBox[{
     "i_", ",", " ", "coordlist_", ",", " ", "axis_", ",", "dx_", ",", 
      "dy_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"coord", "=", 
         RowBox[{"Part", "[", 
          RowBox[{"axis", ",", "i"}], "]"}]}], ",", "e", ",", " ", "j", ",", 
        "nei", ",", "itab", ",", " ", "out", ",", " ", "output"}], "}"}], ",",
       "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"j", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"coordlist", ",", " ", "coord"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"nei", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"coord", "-", 
            RowBox[{"{", 
             RowBox[{"dx", ",", "dy"}], "}"}]}], "}"}], ",", " ", 
          "coordlist"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"itab", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Length", "[", "nei", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"out", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Insert", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{"coordlist", ",", 
                RowBox[{"nei", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "[", "nei", "]"}]}], "}"}]}], "]"}], ",", 
           "j", ",", "itab"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "nei", "]"}], "\[Equal]", "1"}], ",", " ", 
         RowBox[{"output", "=", 
          RowBox[{"{", 
           RowBox[{"out", ",", " ", 
            RowBox[{"Reverse", "[", "out", "]"}]}], "}"}]}], ",", " ", 
         "Nothing"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.7337646974030485`*^9, 3.7337647709347105`*^9}, {
  3.759268169014173*^9, 
  3.759268175764388*^9}},ExpressionUUID->"73f0dedb-91b9-4b4e-a535-\
50baa71bfd29"],

Cell["\<\
These functions are Mirror Functions and other functions for working in a \
Quarter of the carpet, these are used in the construction of complete \
Eigenstates using Parity about given axes.\
\>", "Text",
 CellChangeTimes->{{3.7337649967575293`*^9, 3.733765026037496*^9}, {
  3.7337650794464345`*^9, 
  3.7337651260534277`*^9}},ExpressionUUID->"77c51165-2198-44ec-83bf-\
0dda4d2c3c60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MirrorY", "[", 
   RowBox[{"coords_", ",", "endpoint_", ",", "parity_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"output", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"endpoint", "-", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"parity", "*", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MirrorDiagUp", "[", 
   RowBox[{"coords_", ",", "endpoint_", ",", "parity_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"output", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"parity", "*", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MirrorDiagDown", "[", 
   RowBox[{"coords_", ",", "endpoint_", ",", "parity_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"output", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"endpoint", "-", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"endpoint", "-", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"parity", "*", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MirrorX", "[", 
   RowBox[{"coords_", ",", "endpoint_", ",", "parity_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"output", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"coords", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"endpoint", "-", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"parity", "*", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"quartersquare", "[", 
    RowBox[{"coords_", ",", "endpoint_"}], "]"}], ":=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"coords", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], "/;", " ", 
      RowBox[{
       RowBox[{"x", ">", " ", 
        RowBox[{"endpoint", "/", "2"}]}], " ", "\[Or]", " ", 
       RowBox[{"y", ">", 
        RowBox[{"endpoint", "/", "2"}]}]}]}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.733765059575998*^9, 3.733765075671017*^9}, {
  3.7592681795412965`*^9, 
  3.759268184372388*^9}},ExpressionUUID->"990bbd6e-a717-468f-ad99-\
bd744409f6e0"],

Cell["\<\
These functions are used to construct the 0-Potential Hamiltonian, using a \
quarter of a square\
\>", "Text",
 CellChangeTimes->{{3.7337651433493896`*^9, 
  3.733765179157359*^9}},ExpressionUUID->"f2912582-c8ee-491e-be15-\
56f80de471cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Create", " ", "the", " ", "Sparse", " ", "Array"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"hamiltonianarray3", "[", 
     RowBox[{
     "coordlist_", ",", " ", "xparity_", ",", "yparity_", ",", "xaxis_", ",", 
      "yaxis_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lengthh", "=", 
         RowBox[{"Length", "[", "coordlist", "]"}]}], ",", "diagonal", ",", 
        "adjacentcoords", ",", "offsetdiags", ",", "sqrt2coords", ",", 
        "sqrt2diags", ",", " ", "output"}], "}"}], ",", "\[IndentingNewLine]",
       "\t", 
      RowBox[{
       RowBox[{"diagonal", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", 
           RowBox[{"-", "4."}]}], ",", 
          RowBox[{"{", 
           RowBox[{"lengthh", ",", "lengthh"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"adjacentcoords", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"isInside5", "[", 
             RowBox[{"i", ",", "coordlist"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "lengthh"}], "}"}]}], "]"}], ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"offsetdiags", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"adjacentcoords", "\[Rule]", "1."}], ",", 
          RowBox[{"{", 
           RowBox[{"lengthh", ",", "lengthh"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
         "xparity", "\[Equal]", " ", "yparity", "\[Equal]", " ", "1"}], ",", 
         " ", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"sqrt2coords", "=", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"ParallelTable", "[", 
               RowBox[{
                RowBox[{"isinaxis2", "[", 
                 RowBox[{
                 "i", ",", "coordlist", ",", " ", "xaxis", ",", "0", ",", 
                  "1"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", " ", 
                  RowBox[{"Length", "[", "xaxis", "]"}]}], "}"}]}], "]"}], 
              ",", "1"}], "]"}], ",", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"ParallelTable", "[", 
               RowBox[{
                RowBox[{"isinaxis2", "[", 
                 RowBox[{
                 "i", ",", "coordlist", ",", " ", "yaxis", ",", "1", ",", 
                  "0"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", " ", 
                  RowBox[{"Length", "[", "yaxis", "]"}]}], "}"}]}], "]"}], 
              ",", "1"}], "]"}]}], "]"}]}], ",", " ", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xparity", "\[Equal]", " ", "1"}], " ", "&&", " ", 
             "yparity"}], " ", "=", " ", 
            RowBox[{"-", "1"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"sqrt2coords", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"ParallelTable", "[", 
               RowBox[{
                RowBox[{"isinaxis2", "[", 
                 RowBox[{
                 "i", ",", "coordlist", ",", " ", "xaxis", ",", "0", ",", 
                  "1"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", " ", 
                  RowBox[{"Length", "[", "xaxis", "]"}]}], "}"}]}], "]"}], 
              ",", "1"}], "]"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"xparity", " ", "\[Equal]", " ", 
               RowBox[{"-", "1"}]}], " ", "&&", " ", 
              RowBox[{"yparity", " ", "\[Equal]", " ", "1"}]}], ",", "\n", 
             "\t\t\t\t", 
             RowBox[{"sqrt2coords", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"ParallelTable", "[", 
                 RowBox[{
                  RowBox[{"isinaxis2", "[", 
                   RowBox[{
                   "i", ",", "coordlist", ",", " ", "yaxis", ",", "0", ",", 
                    "1"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", " ", 
                    RowBox[{"Length", "[", "yaxis", "]"}]}], "}"}]}], "]"}], 
                ",", "1"}], "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{"sqrt2coords", "=", 
              RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "\t\t\t", 
            "]"}]}], "\n", "\t\t", "]"}]}], "\n", "\t", "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"sqrt2diags", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"sqrt2coords", "\[Rule]", " ", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"Sqrt", "[", "2", "]"}], "-", "1"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"lengthh", ",", " ", "lengthh"}], "}"}]}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"output", "=", 
        RowBox[{"diagonal", "+", "offsetdiags", "+", "sqrt2diags"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"This", " ", "function", " ", "creates", " ", "the", " ", "0"}],
       "-", "Potential", "-", "Hamiltonian"}], ",", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "Or", " ", "Laplacian", " ", "in", " ", "a", " ", "potential", " ", 
        "with", " ", "X"}], ",", " ", 
       RowBox[{
        RowBox[{"and", " ", "Y"}], "-", 
        RowBox[{"axes", " ", "symmetries"}]}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"fractalHamiltonian", "[", 
     RowBox[{"it_", ",", "pr_", ",", "xparity_", ",", "yparity_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "endpoint", ",", "boxwall", ",", "box", ",", "fractalcoords", ",", 
        "removedpoints", ",", "validpoints", ",", "validsquare", ",", "xaxis",
         ",", "yaxis", ",", "b", ",", "c", ",", "coords", ",", 
        "removedsquare", ",", "psiq", ",", "d", ",", "e"}], "}"}], ",", 
      "\[IndentingNewLine]", "\n", "\t", 
      RowBox[{
       RowBox[{"endpoint", " ", "=", " ", 
        RowBox[{"it", "*", 
         RowBox[{"3", "^", "pr"}]}]}], ";", "\n", "    ", 
       RowBox[{"boxwall", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "0", ",", "endpoint"}], "}"}]}], "]"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"endpoint", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "0", ",", "endpoint"}], "}"}]}], "]"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "endpoint"}], "}"}]}], "]"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "endpoint"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "endpoint"}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"box", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "endpoint"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "0", ",", "endpoint"}], "}"}]}], "]"}], ",", 
          "1"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"fractalcoords", " ", "=", " ", 
        RowBox[{"fractalcoordinates2", "[", 
         RowBox[{"it", ",", "pr"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"removedpoints", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"boxwall", ",", "fractalcoords"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"validpoints", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"box", ",", "removedpoints"}], "]"}]}], ";", "\n", "    ", 
       RowBox[{"validsquare", " ", "=", " ", 
        RowBox[{"quartersquare", "[", 
         RowBox[{"validpoints", ",", "endpoint"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"removedsquare", " ", "=", " ", 
        RowBox[{"quartersquare", "[", 
         RowBox[{"removedpoints", ",", "endpoint"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"xaxis", " ", "=", " ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"(", "endpoint", ")"}], "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1", ",", 
            RowBox[{"endpoint", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"yaxis", " ", "=", " ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", "endpoint", ")"}], "/", "2"}], ",", "y"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "1", ",", 
            RowBox[{"endpoint", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"b", " ", "=", " ", 
        RowBox[{"hamiltonianarray3", "[", 
         RowBox[{
         "validsquare", ",", "xparity", ",", "yparity", ",", "xaxis", ",", 
          "yaxis"}], "]"}]}], ";", "\n", "\t", "\n", 
       RowBox[{"{", 
        RowBox[{
        "b", ",", "endpoint", ",", "validsquare", ",", "removedsquare"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Code",
 CellChangeTimes->{
  3.733765767161937*^9, {3.733765799866338*^9, 3.73376589631325*^9}, {
   3.7337659437526646`*^9, 3.733765962442517*^9}, {3.759268189526593*^9, 
   3.759268297863405*^9}, {3.7592683278785954`*^9, 3.759268368935229*^9}, {
   3.759268402853716*^9, 
   3.7592684361348057`*^9}},ExpressionUUID->"cf9849af-a726-46bf-a764-\
85c30d8a1806"],

Cell["\<\
This function creates the Laplacian Operator Matrix, for any space, including \
those without Symmetries. Because of the lack of Symmetries it is much slower \
at computation.\
\>", "Text",
 CellChangeTimes->{{3.7337659695098476`*^9, 
  3.733766012742645*^9}},ExpressionUUID->"4ef67800-a32f-486a-a19d-\
0c58c5d648c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hamiltonianarray", "[", "coordlist_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"lengthh", "=", 
       RowBox[{"Length", "[", "coordlist", "]"}]}], ",", "diagonal", ",", 
      "adjacentcoords", ",", "offsetdiags", ",", "output"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"diagonal", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", 
         RowBox[{"-", "4."}]}], ",", 
        RowBox[{"{", 
         RowBox[{"lengthh", ",", "lengthh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"adjacentcoords", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"isInside5", "[", 
           RowBox[{"i", ",", "coordlist"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "lengthh"}], "}"}]}], "]"}], ",", 
        "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"offsetdiags", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"adjacentcoords", "\[Rule]", "1."}], ",", 
        RowBox[{"{", 
         RowBox[{"lengthh", ",", "lengthh"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"output", "=", 
      RowBox[{"diagonal", "+", "offsetdiags"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.733934674490687*^9, 3.7339346779962206`*^9}, {
  3.759268442501234*^9, 
  3.7592684485803647`*^9}},ExpressionUUID->"07ae14c0-3a4e-44ec-860e-\
10fb0d844c22"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Circuit Construction Function", "Subsubsection",
 CellChangeTimes->{{3.7339351832244024`*^9, 3.7339351899755087`*^9}, {
  3.7339352307276506`*^9, 
  3.733935250103578*^9}},ExpressionUUID->"3a185e54-e886-4993-b88c-\
452ebf6655f9"],

Cell["\<\
This function constructs a set of coordinates for a given precision and \
iteration that include the carpet and connected terminals. This is called for \
simulations in time that require it.
It outputs relevant data needed for further computation: The list of \
coordinates inside the carpet (So analysis may be done on that region), \
Source and Sink coordinates, so that the simulation
may fix these at each step to prevent backscattering (The simulation will \
cause any incoming wave to be reflected upon reaching an end in coordinates \
(act\[CloseCurlyQuote]s as infinite potential barrier) to create a flow.\
\>", "Text",
 CellChangeTimes->{{3.73393526659995*^9, 
  3.7339354957116985`*^9}},ExpressionUUID->"3e3fe2aa-7e10-4c91-bc5e-\
59556ed49cad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Create", " ", "a", " ", "vertical", " ", "grid", " ", "with", " ", "a", 
     " ", "veritical", " ", "termininal", " ", "centred", " ", "on", " ", 
     "the", " ", "y"}], "-", "axis"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"coordinateConstructionVert", "[", 
     RowBox[{
     "it_", ",", "prec_", ",", " ", "sradius_", ",", " ", "sLength_"}], "]"}],
     ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fractalcoords", ",", "varn", ",", "boxwall", ",", "box", ",", 
        "square", ",", "removedcoords", ",", "validboxcoords", ",", " ", 
        "sourcecoords", ",", "sinkcoords", ",", "sourcewall", ",", "sinkwall",
         ",", "validpoints", ",", "removedpoints"}], "}"}], ",", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Box", " ", "runs", " ", "from"}], " ", "-", "Varn"}], ",", 
        " ", 
        RowBox[{"...", " ", "0"}], ",", " ", "Varn"}], " ", "*)"}], " ", "\n",
       "\t", 
      RowBox[{
       RowBox[{"varn", " ", "=", " ", 
        RowBox[{"prec", "*", 
         RowBox[{"3", "^", "it"}]}]}], ";", "\n", "\t", 
       RowBox[{"box", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "varn"}], ",", "varn", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "varn"}], ",", "varn", ",", "1"}], "}"}]}], "]"}], 
          ",", "1"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"boxwall", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "varn"}], ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "varn"}], ",", "varn"}], "}"}]}], "]"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"varn", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "varn"}], ",", "varn"}], "}"}]}], "]"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "varn"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "varn"}], ",", "varn"}], "}"}]}], "]"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "varn"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "varn"}], ",", "varn"}], "}"}]}], "]"}]}], "]"}]}],
        ";", "\n", "\t", 
       RowBox[{"fractalcoords", " ", "=", " ", 
        RowBox[{"fractalGeneration", "[", 
         RowBox[{"it", ",", "prec"}], "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"removedcoords", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"fractalcoords", ",", "boxwall"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"validboxcoords", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"box", ",", "removedcoords"}], "]"}]}], ";", "\n", "\n", 
       "\t", 
       RowBox[{"sourcecoords", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "sradius"}], ",", "sradius"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "varn", ",", 
              RowBox[{"varn", "+", "sLength"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"sourcewall", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Union", "[", "\n", "\t", 
           RowBox[{
            RowBox[{"ParallelTable", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"varn", "+", "1"}], ",", 
                RowBox[{"varn", "+", "sLength"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "varn"}], ",", 
                RowBox[{
                 RowBox[{"-", "sradius"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
            "\n", "\t", 
            RowBox[{"ParallelTable", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"varn", "+", "1"}], ",", 
                RowBox[{"varn", "+", "sLength"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"sradius", "+", "1"}], ",", "varn"}], "}"}]}], 
             "]"}]}], "]"}], "\n", ",", "1"}], "]"}]}], ";", "\n", 
       RowBox[{"sinkcoords", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "sradius"}], ",", "sradius"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{
               RowBox[{"-", "varn"}], "-", "sLength"}], ",", 
              RowBox[{"-", "varn"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
       ";", "\n", 
       RowBox[{"sinkwall", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Union", "[", "\n", 
           RowBox[{
            RowBox[{"ParallelTable", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"-", "varn"}], "-", "sLength"}], ",", 
                RowBox[{
                 RowBox[{"-", "varn"}], "-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "varn"}], ",", 
                RowBox[{
                 RowBox[{"-", "sradius"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
            "\n", 
            RowBox[{"ParallelTable", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"-", "varn"}], "-", "sLength"}], ",", 
                RowBox[{
                 RowBox[{"-", "varn"}], "-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"sradius", "+", "1"}], ",", "varn"}], "}"}]}], 
             "]"}]}], "]"}], "\n", ",", "1"}], "]"}]}], ";", "\n", 
       RowBox[{"validpoints", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"validboxcoords", ",", "sourcecoords", ",", "sinkcoords"}], 
         "]"}]}], ";", "\n", 
       RowBox[{"removedpoints", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{"removedcoords", ",", "sinkcoords", ",", "sourcecoords"}], 
           "]"}], ",", "sourcewall", ",", "sinkwall"}], "]"}]}], ";", "\n", 
       "\n", 
       RowBox[{"{", 
        RowBox[{
        "validpoints", ",", "varn", ",", "removedpoints", ",", 
         "validboxcoords", ",", "sourcecoords", ",", "sinkcoords", ",", 
         "removedcoords"}], "}"}]}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Create", " ", "a", " ", "grid", " ", "with", " ", "4", " ", "diagonal", 
     " ", "terminals"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"coordinateConstructionDiag", "[", 
     RowBox[{
     "it_", ",", "prec_", ",", " ", "sradius_", ",", " ", "sLength_"}], "]"}],
     ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fractalcoords", ",", "varn", ",", "boxwall", ",", "box", ",", 
        "square", ",", "removedcoords", ",", "validboxcoords", ",", " ", "ur",
         ",", "ul", ",", "lr", ",", "ll", ",", "sinkcoords", ",", 
        "sourcewall", ",", "sinkwall", ",", "validpoints", ",", "\n", 
        "removedpoints"}], "}"}], ",", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Box", " ", "runs", " ", "from"}], " ", "-", "Varn"}], ",", 
        " ", 
        RowBox[{"...", " ", "0"}], ",", " ", "Varn"}], " ", "*)"}], " ", "\n",
       "\t", 
      RowBox[{
       RowBox[{"varn", " ", "=", " ", 
        RowBox[{"prec", "*", 
         RowBox[{"3", "^", "it"}]}]}], ";", "\n", "\t", 
       RowBox[{"box", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "varn"}], ",", "varn", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "varn"}], ",", "varn", ",", "1"}], "}"}]}], "]"}], 
          ",", "1"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"boxwall", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "varn"}], ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "varn"}], ",", "varn"}], "}"}]}], "]"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"varn", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "varn"}], ",", "varn"}], "}"}]}], "]"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "varn"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "varn"}], ",", "varn"}], "}"}]}], "]"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "varn"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "varn"}], ",", "varn"}], "}"}]}], "]"}]}], "]"}]}],
        ";", "\n", "\t", 
       RowBox[{"fractalcoords", " ", "=", " ", 
        RowBox[{"fractalGeneration", "[", 
         RowBox[{"it", ",", "prec"}], "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"removedcoords", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"fractalcoords", ",", "boxwall"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"validboxcoords", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"box", ",", "removedcoords"}], "]"}]}], ";", "\n", "\n", 
       "\t", 
       RowBox[{"ur", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"x", "+", "i"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"varn", "-", "1"}], ",", 
              RowBox[{"varn", "+", "sLength"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "sradius"}], ",", "sradius"}], "}"}]}], "]"}], ",",
           "1"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"ul", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "x"}], ",", 
              RowBox[{"x", "+", "i"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"varn", "-", "1"}], ",", 
              RowBox[{"varn", "+", "sLength"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "sradius"}], ",", "sradius"}], "}"}]}], "]"}], ",",
           "1"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"ll", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"x", "+", "i"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"-", "varn"}], "-", "sLength"}], ",", 
              RowBox[{
               RowBox[{"-", "varn"}], "+", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "sradius"}], ",", "sradius"}], "}"}]}], "]"}], ",",
           "1"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"lr", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"-", "x"}], "-", "i"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"varn", "-", "1"}], ",", 
              RowBox[{"varn", "+", "sLength"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "sradius"}], ",", "sradius"}], "}"}]}], "]"}], ",",
           "1"}], "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"validpoints", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{
         "validboxcoords", ",", "ul", ",", "ur", ",", "ll", ",", "lr"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"removedpoints", " ", "=", " ", "removedcoords"}], ";", "\n", 
       "\n", "\t", 
       RowBox[{"{", 
        RowBox[{
        "validpoints", ",", "varn", ",", "removedpoints", ",", 
         "validboxcoords", ",", "ul", ",", "ur", ",", "ll", ",", "lr"}], 
        "}"}]}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "function", " ", "gets", " ", "the", " ", "position", " ", 
      "of", " ", "a", " ", "given", " ", "sublist", " ", "from", " ", 
      "within", " ", "a", " ", "list"}], ",", " ", 
     RowBox[{
     "this", " ", "is", " ", "so", " ", "we", " ", "can", " ", "set", " ", 
      "these", " ", "indicies", " ", "to", " ", "certain", " ", "values"}]}], 
    "*)"}], " ", "\n", 
   RowBox[{
    RowBox[{"getindexposition", "[", 
     RowBox[{"fullcoords_", ",", "input_"}], "]"}], ":=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"fullcoords", ",", 
         RowBox[{"input", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "input", "]"}]}], "}"}]}], "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.7339355035119605`*^9, 3.733935638505616*^9}, {
   3.7339356898315887`*^9, 3.73393594164001*^9}, {3.733936095815545*^9, 
   3.733936161001404*^9}, {3.733936214312637*^9, 3.733936295880533*^9}, {
   3.7339363303123636`*^9, 3.73393637423104*^9}, {3.733936487463744*^9, 
   3.7339368497357163`*^9}, {3.733936883800351*^9, 3.733937209418232*^9}, {
   3.7339375066150713`*^9, 3.7339376567132196`*^9}, {3.7339376965696006`*^9, 
   3.7339377659132156`*^9}, {3.7339381085072994`*^9, 
   3.7339381301354084`*^9}, {3.7339382346316056`*^9, 
   3.7339382651791215`*^9}, {3.733938312503206*^9, 3.733938505767275*^9}, {
   3.733939427140745*^9, 3.733939537538579*^9}, {3.7339396243110332`*^9, 
   3.7339396403235426`*^9}, {3.7339397426499724`*^9, 
   3.7339397706785746`*^9}, {3.73393980130544*^9, 3.733939806064537*^9}, {
   3.733940162165414*^9, 3.733940163397077*^9}, {3.7339401958141713`*^9, 
   3.7339402232281275`*^9}, {3.734107623853515*^9, 3.734107637004657*^9}, {
   3.734107674138288*^9, 3.7341076764885826`*^9}, {3.734107711242567*^9, 
   3.734107714360956*^9}, 3.7341077532415724`*^9, {3.73410783815418*^9, 
   3.734107896961045*^9}, {3.734107934057682*^9, 3.7341079442809577`*^9}, 
   3.7341079837376575`*^9, {3.7341080204733753`*^9, 3.7341080421529207`*^9}, {
   3.734108294042632*^9, 3.734108301991624*^9}, {3.734722021366976*^9, 
   3.73472202307246*^9}, {3.7347222994805727`*^9, 3.7347223138643594`*^9}, {
   3.734725111468526*^9, 3.7347254142361555`*^9}, 3.734725611999757*^9, 
   3.7347258432636757`*^9, {3.7347259818556457`*^9, 3.734725986317219*^9}, {
   3.7347304516450987`*^9, 3.7347304635486593`*^9}, {3.759268535336828*^9, 
   3.7592685526965246`*^9}, {3.7592706157852793`*^9, 
   3.759270647673423*^9}},ExpressionUUID->"51d9c60c-5616-4277-a298-\
95d1b2a4aeaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["    4.Time-Evolution", "Subsection",
 CellChangeTimes->{{3.7337528749252396`*^9, 3.733752879357401*^9}, {
  3.733938604547814*^9, 3.73393860499537*^9}, {3.7341073297651844`*^9, 
  3.7341073311243515`*^9}},ExpressionUUID->"260799f4-9169-4a02-a943-\
18e97ca38163"],

Cell[TextData[{
 "Here we have time evolution functions. We have here our old Matrix \
Exponential function, in addition to a more general  RK2 set of functions. \
The RK2 function combines both an explicit RK2 and an implicit RK2 done with \
a user-defined number of iterations. The matrix exponential works on time \
independent potentials only. From H\[Psi] = -i",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], "\[Psi]"}], TraditionalForm]],
  ExpressionUUID->"87d647e4-0f18-4141-b523-2263832f77af"],
 " can treat it as a 1st order ODE. i.e. \[Psi](t+dt) = exp[-iHdt]\[Psi](t). \
The RK2 functions can take an arbitary potential function of the form \
f[coordinates, time] i.e. V(x,y,t)."
}], "Text",
 CellChangeTimes->{{3.7337528881567116`*^9, 3.7337529528284454`*^9}, {
  3.733938811602995*^9, 3.7339389747565575`*^9}, {3.7339390055874343`*^9, 
  3.7339391332352467`*^9}, {3.7339408746469555`*^9, 3.733940877405302*^9}, {
  3.734104773932794*^9, 3.734104813755891*^9}, {3.7341048527316957`*^9, 
  3.7341048629866853`*^9}, {3.734106276553604*^9, 
  3.734106323303607*^9}},ExpressionUUID->"6b7be7fc-fffe-4cc2-ac62-\
fe364051dae9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Explicit", " ", "RK2"}], ",", " ", 
    RowBox[{
    "takes", " ", "our", " ", "laplacian", " ", "Matrix", " ", "operator"}], 
    ",", " ", 
    RowBox[{"our", " ", "potential", " ", "functions"}], ",", " ", 
    RowBox[{"coordinates", " ", 
     RowBox[{"(", 
      RowBox[{"inc", ".", " ", "time"}], ")"}], " ", "to", " ", "calculate", 
     " ", "\[Psi]", " ", "for", " ", "the", " ", "next", " ", "jump", " ", 
     "in", " ", "time"}]}], "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "NB", " ", "for", " ", "this", " ", "our", " ", "lap", " ", "needs", " ", 
     "to", " ", "be"}], " ", "-", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Del]", "2"], "/", "2"}], " ", "so", " ", "remember"}],
     " ", "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", 
     RowBox[{"prefactor", "!"}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"rk2Ex", "[", 
     RowBox[{
     "lap_", ",", " ", "\[Psi]0_", ",", " ", "fV_", ",", "dt_", ",", 
      "coords_", ",", "t0_", ",", "param_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2", ",", "vplus", ",", "output"}], "}"}], ",", 
      "\n", "\n", "\t", 
      RowBox[{
       RowBox[{"k1", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dt", "/", "I"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lap", ".", "\[Psi]0"}], "+", 
           RowBox[{
            RowBox[{"fV", "[", 
             RowBox[{"coords", ",", "t0", ",", "param"}], "]"}], ".", 
            "\[Psi]0"}]}], ")"}]}]}], ";", "\n", "\t", 
       RowBox[{"vplus", " ", "=", " ", 
        RowBox[{"fV", "[", 
         RowBox[{"coords", ",", 
          RowBox[{"t0", "+", 
           RowBox[{"dt", "/", "2"}]}], ",", "param"}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"k2", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dt", "/", "I"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lap", ".", "\[Psi]0"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "*", 
            RowBox[{"lap", ".", "k1"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "*", 
            RowBox[{"vplus", ".", "k1"}]}], "+", 
           RowBox[{"vplus", ".", "\[Psi]0"}]}], ")"}]}]}], ";", "\n", "\n", 
       "\t", 
       RowBox[{"output", " ", "=", " ", 
        RowBox[{"\[Psi]0", " ", "+", " ", "k2"}]}]}]}], "\n", "\n", "]"}]}], 
   "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "For", " ", "each", " ", "step", " ", "of", " ", "the", " ", "time", " ",
       "simulation"}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "input", " ", "the", " ", "output", " ", "of", " ", "our", 
       " ", "explicit", " ", "RK2", " ", "into", " ", "our", " ", "implicit", 
       " ", "formala", " ", "for", " ", "a", " ", "Predictor"}], "-", 
      RowBox[{"Corrector", " ", 
       RowBox[{"method", "."}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"rk2Im", "[", 
     RowBox[{"lap_", ",", " ", "dt_", ",", " ", 
      RowBox[{"t0_", " ", "\[Psi]0_"}], ",", " ", "\[Psi]1_", ",", " ", 
      "Vplus_", ",", " ", "iterations_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", ",", " ", "\[Psi]comb", ",", "\[Psi]2"}], "}"}], ",",
       "\n", "\n", "\t", 
      RowBox[{
       RowBox[{"\[Psi]2", " ", "=", " ", "\[Psi]1"}], ";", "\n", "\t", 
       RowBox[{"Do", "[", " ", "\n", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]comb", " ", "=", " ", 
           RowBox[{"0.5", "*", 
            RowBox[{"(", 
             RowBox[{"dt", "/", "I"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"\[Psi]0", "+", "\[Psi]2"}], ")"}]}]}], ";", "\n", 
          "\t\t", 
          RowBox[{"\[Psi]2", " ", "=", " ", 
           RowBox[{"\[Psi]0", " ", "+", " ", 
            RowBox[{"lap", ".", "\[Psi]comb"}], " ", "+", " ", 
            RowBox[{"Vplus", ".", "\[Psi]comb"}]}]}]}], ",", "\n", "\t\t", 
         "iterations"}], "\n", "\t", "]"}], ";", "\n", "\t", 
       RowBox[{"output", " ", "=", " ", "\[Psi]2"}]}]}], "\n", "]"}]}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"RK2FullStep", "[", 
     RowBox[{
     "lap_", ",", "\[Psi]0_", ",", "fV_", ",", "dt_", ",", "coords_", ",", 
      "t0_", ",", "param_", ",", "iterations_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "k1", ",", "k2", ",", "vplus", ",", "\[Psi]out", ",", "\[Psi]comb"}], 
       "}"}], ",", "\n", "\n", "\t", 
      RowBox[{
       RowBox[{"k1", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dt", "/", "I"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lap", ".", "\[Psi]0"}], "+", 
           RowBox[{
            RowBox[{"fV", "[", 
             RowBox[{"coords", ",", "t0", ",", "param"}], "]"}], ".", 
            "\[Psi]0"}]}], ")"}]}]}], ";", "\n", "\t", 
       RowBox[{"vplus", " ", "=", " ", 
        RowBox[{"fV", "[", 
         RowBox[{"coords", ",", 
          RowBox[{"t0", "+", 
           RowBox[{"dt", "/", "2"}]}], ",", "param"}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"k2", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dt", "/", "I"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lap", ".", "\[Psi]0"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "*", 
            RowBox[{"lap", ".", "k1"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "*", 
            RowBox[{"vplus", ".", "k1"}]}], "+", 
           RowBox[{"vplus", ".", "\[Psi]0"}]}], ")"}]}]}], ";", "\n", "\n", 
       "\t", 
       RowBox[{"\[Psi]out", " ", "=", " ", 
        RowBox[{"\[Psi]0", " ", "+", " ", "k2"}]}], ";", "\n", "\t", 
       RowBox[{"Do", "[", " ", "\n", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]comb", " ", "=", " ", 
           RowBox[{"0.5", "*", 
            RowBox[{"(", 
             RowBox[{"dt", "/", "I"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"\[Psi]0", "+", "\[Psi]out"}], ")"}]}]}], ";", "\n", 
          "\t\t", 
          RowBox[{"\[Psi]out", " ", "=", " ", 
           RowBox[{"\[Psi]0", " ", "+", " ", 
            RowBox[{"lap", ".", "\[Psi]comb"}], " ", "+", " ", 
            RowBox[{"vplus", ".", "\[Psi]comb"}]}]}]}], ",", "\n", "\t\t", 
         "iterations"}], "\n", "\t", "]"}], ";", "\n", "\t", "\[Psi]out"}]}], 
     "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"RK2FullStepTI", "[", 
     RowBox[{
     "lap_", ",", "\[Psi]0_", ",", "V_", ",", "dt_", ",", "coords_", ",", 
      "t0_", ",", "iterations_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "k1", ",", "k2", ",", "vplus", ",", "\[Psi]out", ",", "\[Psi]comb"}], 
       "}"}], ",", "\n", "\n", "\t", 
      RowBox[{
       RowBox[{"k1", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dt", "/", "I"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lap", ".", "\[Psi]0"}], "+", 
            RowBox[{"V", ".", "\[Psi]0"}]}], ")"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"vplus", " ", "=", " ", "V"}], ";", "\n", "\t", 
       RowBox[{"k2", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dt", "/", "I"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lap", ".", "\[Psi]0"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"lap", ".", "k1"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", 
             RowBox[{"vplus", ".", "k1"}]}], "+", 
            RowBox[{"vplus", ".", "\[Psi]0"}]}], ")"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"\[Psi]out", " ", "=", " ", 
        RowBox[{"\[Psi]0", " ", "+", " ", "k2"}]}], ";", "\n", "\t", 
       RowBox[{"Do", "[", " ", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]comb", " ", "=", " ", 
           RowBox[{"N", "[", 
            RowBox[{"0.5", "*", 
             RowBox[{"(", 
              RowBox[{"dt", "/", "I"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"\[Psi]0", "+", "\[Psi]out"}], ")"}]}], "]"}]}], ";", 
          "\n", "\t\t", 
          RowBox[{"\[Psi]out", " ", "=", " ", 
           RowBox[{"N", "[", 
            RowBox[{"\[Psi]0", " ", "+", " ", 
             RowBox[{"lap", ".", "\[Psi]comb"}], " ", "+", " ", 
             RowBox[{"vplus", ".", "\[Psi]comb"}]}], "]"}]}]}], ",", "\n", 
         "\t\t", "iterations"}], "\n", "\t", "]"}], ";", "\n", "\n", "\t", 
       "\[Psi]out"}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"RK2FullStepTI2", "[", 
     RowBox[{"H_", ",", "\[Psi]0_", ",", "dt_", ",", "iterations_"}], "]"}], ":=",
     " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2", ",", "\[Psi]out", ",", "\[Psi]comb"}], "}"}], 
      ",", "\n", "\n", "\t", 
      RowBox[{
       RowBox[{"k1", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dt", "/", "I"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"H", ".", "\[Psi]0"}], ")"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"k2", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dt", "/", "I"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"H", ".", 
            RowBox[{"(", 
             RowBox[{"\[Psi]0", "+", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}], "*", "k1"}], "]"}]}], 
             ")"}]}], ")"}]}], "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"\[Psi]out", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{"\[Psi]0", " ", "+", " ", "k2"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Do", "[", " ", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]comb", " ", "=", " ", 
           RowBox[{"N", "[", 
            RowBox[{"0.5", "*", 
             RowBox[{"(", 
              RowBox[{"dt", "/", "I"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"\[Psi]0", "+", "\[Psi]out"}], ")"}]}], "]"}]}], ";", 
          "\n", "\t\t", 
          RowBox[{"\[Psi]out", " ", "=", " ", 
           RowBox[{"N", "[", 
            RowBox[{"\[Psi]0", " ", "+", " ", 
             RowBox[{"H", ".", "\[Psi]comb"}]}], "]"}]}]}], ",", "\n", "\t\t",
          "iterations"}], "\n", "\t", "]"}], ";", "\n", "\t", "\[Psi]out"}]}],
      "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x_", ",", "h_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", ",", "h"}], "]"}], "=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "output", "}"}], ",", "\n", "\t", 
        RowBox[{"output", " ", "=", " ", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"h", ",", 
           RowBox[{"f", "[", 
            RowBox[{
             RowBox[{"x", "-", "1"}], ",", "h"}], "]"}]}], "]"}]}]}], "\n", 
       "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"RK2FullStepTI3", "[", 
     RowBox[{"H_", ",", "\[Psi]0_", ",", "dt_", ",", "iterations_"}], "]"}], ":=",
     " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2", ",", "\[Psi]out", ",", "\[Psi]comb"}], "}"}], 
      ",", "\n", "\n", "\t", 
      RowBox[{
       RowBox[{"k1", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dt", "/", "I"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"H", ".", "\[Psi]0"}], ")"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"k2", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{"k1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dt", "/", "I"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"H", ".", 
             RowBox[{"(", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}], "*", "k1"}], "]"}], ")"}]}], 
            ")"}]}]}], "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"\[Psi]out", " ", "=", " ", 
        RowBox[{"N", "[", 
         RowBox[{"\[Psi]0", " ", "+", " ", "k2"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]comb", " ", "=", " ", 
           RowBox[{"N", "[", 
            RowBox[{"0.5", "*", 
             RowBox[{"(", 
              RowBox[{"dt", "/", "I"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"\[Psi]0", "+", "\[Psi]out"}], ")"}]}], "]"}]}], ";", 
          "\n", "\t\t", 
          RowBox[{"\[Psi]out", " ", "=", " ", 
           RowBox[{"N", "[", 
            RowBox[{"\[Psi]0", " ", "+", " ", 
             RowBox[{"H", ".", "\[Psi]comb"}]}], "]"}]}]}], ",", "\n", "\t\t",
          "iterations"}], "\n", "\t", "]"}], ";", "\n", "\n", "\t", 
       "\[Psi]out"}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x_", ",", "h_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", ",", "h"}], "]"}], "=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "output", "}"}], ",", "\n", "\t", 
        RowBox[{"output", " ", "=", " ", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"h", ",", 
           RowBox[{"f", "[", 
            RowBox[{
             RowBox[{"x", "-", "1"}], ",", "h"}], "]"}]}], "]"}]}]}], "\n", 
       "]"}]}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.733939420035845*^9, 3.73393942182607*^9}, {
   3.7339410008088765`*^9, 3.733941014192556*^9}, {3.733941061689044*^9, 
   3.7339411058246164`*^9}, {3.733941220448634*^9, 3.7339413276321335`*^9}, {
   3.733941403090126*^9, 3.7339415309812775`*^9}, {3.73394166028957*^9, 
   3.7339417899999256`*^9}, 3.733941849472437*^9, 3.7339418933119526`*^9, {
   3.7339419265601325`*^9, 3.7339420374240866`*^9}, 3.7339420684805183`*^9, {
   3.7339422499994197`*^9, 3.7339422504314737`*^9}, {3.734102389186335*^9, 
   3.734102394256608*^9}, {3.7341024680004377`*^9, 3.734102482255224*^9}, {
   3.7341027349592113`*^9, 3.7341027575673885`*^9}, {3.734103179855712*^9, 
   3.734103239725184*^9}, {3.7341032704617634`*^9, 3.73410338300541*^9}, {
   3.7341034152291603`*^9, 3.7341034989255767`*^9}, {3.7341035386381893`*^9, 
   3.734103595900339*^9}, {3.7341036349094744`*^9, 3.7341038784155445`*^9}, {
   3.734104227855519*^9, 3.7341042618843794`*^9}, {3.734104515260941*^9, 
   3.734104596397221*^9}, {3.734104690206565*^9, 3.7341046942215786`*^9}, {
   3.734106237144995*^9, 3.734106262281143*^9}, {3.7341065652098913`*^9, 
   3.734106587399717*^9}, {3.7341087002937775`*^9, 3.7341088789321938`*^9}, {
   3.734113984719529*^9, 3.734113988314477*^9}, {3.7341168304840145`*^9, 
   3.7341169025799007`*^9}, {3.734116946116521*^9, 3.734116956834857*^9}, {
   3.734117656371764*^9, 3.7341176839527707`*^9}, {3.7341177434101243`*^9, 
   3.7341177465943213`*^9}, {3.7347264897692575`*^9, 
   3.7347266113683214`*^9}, {3.7348631264937105`*^9, 
   3.7348631422353387`*^9}, {3.734867243942444*^9, 3.7348673607433095`*^9}, {
   3.7348673925361557`*^9, 3.7348674280700903`*^9}, {3.7348909387627273`*^9, 
   3.734890978858591*^9}, {3.759270556474635*^9, 3.7592706040899844`*^9}, {
   3.759270859801911*^9, 
   3.7592709825516644`*^9}},ExpressionUUID->"7fabe12d-6935-4933-aa30-\
eec0b80076e0"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.735032955205944*^9, 
  3.735032965824757*^9}},ExpressionUUID->"e0744fd4-4856-4973-83cb-\
8830599d013d"],

Cell[CellGroupData[{

Cell["5.Potential Functions", "Subsubsection",
 CellChangeTimes->{{3.733752712093261*^9, 3.7337527192774916`*^9}, {
  3.734107320549023*^9, 
  3.734107320677039*^9}},ExpressionUUID->"fdafc1ff-53d8-45e7-96d8-\
19920399a538"],

Cell["\<\
These functions (Many of which can be added) are forms of different \
potentials which can be used with the vector space we have constructed for \
the purposes of simulation. These can be referred to in our Time Simulation. \
Here all functions are of the form V[coordinates, time value, parameters]. \
Parameters take the form of a list which are called in each function. This \
allows the RK2 algorithm above to be generic.\
\>", "Text",
 CellChangeTimes->{{3.7337527365559635`*^9, 3.7337527985085316`*^9}, {
  3.7337528323010035`*^9, 3.7337528569242945`*^9}, {3.7341068358935533`*^9, 
  3.7341068833815155`*^9}},ExpressionUUID->"ef5c5db6-57e3-4d27-8abf-\
ddcca586569b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Zero", " ", "Potential"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"zeroPot", "[", 
      RowBox[{"coords_", ",", "t_", ",", "param_"}], "]"}], ":=", " ", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Ramp", " ", "from", " ", "top", " ", "to", " ", "bottom", " ", "V"}], 
     " ", "=", " ", 
     RowBox[{"Ay", " ", "+", " ", "V0"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"potRampY", "[", 
      RowBox[{"coords_", ",", "t_", ",", "param_", ",", "vn_"}], "]"}], ":=", 
     " ", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"param", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", "vn"}]}], "+", 
          RowBox[{"param", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"potRampY2", "[", 
      RowBox[{"coords_", ",", "t_", ",", "param_", ",", "vn_"}], "]"}], ":=", 
     " ", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ParallelTable", "[", "\n", "\n", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "vn"}], " ", "<", " ", 
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<", " ", "vn"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"param", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"coords", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "vn"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "*", "vn"}], ")"}]}]}], "+", 
            RowBox[{"param", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"coords", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", "\[GreaterEqual]", " ", 
              "vn"}], ",", " ", "0", ",", "\n", "\t\t", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"coords", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "\[LessEqual]", " ", 
                RowBox[{"-", "vn"}]}], ",", " ", 
               RowBox[{"-", 
                RowBox[{"param", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "]"}]}], "\n", 
            "\t\t", "]"}]}], "\n", "\n", "\t", "]"}], ",", "\n", "\n", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Ramp", " ", "from", " ", "left", " ", "to", " ", "right", " ", "V"}], 
     " ", "=", " ", 
     RowBox[{"Ax", " ", "+", " ", "V0"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"potRampX", "[", 
      RowBox[{"coords_", ",", "t_", ",", "param_"}], "]"}], ":=", " ", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"param", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{"param", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Generic", " ", "quadratic", " ", "potential"}], ",", " ", 
     RowBox[{"V", " ", "=", " ", 
      RowBox[{
       SuperscriptBox["Ax", "2"], " ", "+", " ", 
       SuperscriptBox["By", "2"]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"potRampX2Y2", "[", 
      RowBox[{"coords_", ",", "t_", ",", "param_"}], "]"}], ":=", " ", 
     RowBox[{"SparseArray", "[", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"param", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"param", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";"}], "\n", "\n"}]}]], "Code",
 CellChangeTimes->{{3.7341063624555397`*^9, 3.734106480262968*^9}, {
  3.734106592135132*^9, 3.734106621766677*^9}, {3.7341067868867245`*^9, 
  3.7341068271111083`*^9}, {3.734106898373994*^9, 3.7341070945987196`*^9}, {
  3.734107128199269*^9, 3.7341071713191338`*^9}, {3.7341072025179687`*^9, 
  3.734107205269312*^9}, {3.7341096804197197`*^9, 3.734109728594741*^9}, {
  3.7347333885651045`*^9, 3.734733395639645*^9}, {3.7349909078468027`*^9, 
  3.73499097498197*^9}, {3.734991537828415*^9, 3.734991699106487*^9}, {
  3.7349918066911626`*^9, 3.734991838146983*^9}, {3.734992101381649*^9, 
  3.7349921096652336`*^9}, {3.734993433615904*^9, 
  3.734993437183813*^9}},ExpressionUUID->"3bc08337-22e9-4e44-a35e-\
5ee227165d7a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["6. Initial Wave-packet", "Subsection",
 CellChangeTimes->{{3.7341089122913666`*^9, 3.7341089481938543`*^9}, 
   3.7341096745654807`*^9},ExpressionUUID->"2dabc08f-5dfc-4b2f-8306-\
036a472e28d5"],

Cell["\<\
These functions define an initial configuration of the circuit we model which \
is required for any simulation in time. We have an initial Gaussian \
Wave-packet, in addition to terminal specific waves, i.e. from incoming waves \
across the terminals.\
\>", "Text",
 CellChangeTimes->{{3.734108963729801*^9, 3.7341089913297453`*^9}, {
  3.73410904196944*^9, 
  3.734109099734166*^9}},ExpressionUUID->"a883d915-0893-498e-b7d2-\
ede138730f4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Gaussian", " ", "of", " ", "the", " ", "form", " ", "\[Psi]", 
     RowBox[{"(", 
      RowBox[{"x", ",", "y"}], ")"}]}], " ", "=", " ", 
    RowBox[{"A", "*", 
     RowBox[{"exp", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", 
             SubscriptBox["x", "0"]}], ")"}], "2"]}], "/", "2"}], 
        SuperscriptBox[
         SubscriptBox["\[Sigma]", "x"], "2"]}], "-", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y", "-", 
            SubscriptBox["y", "0"]}], ")"}], "2"], "/", "2"}], 
        SuperscriptBox[
         SubscriptBox["\[Sigma]", "y"], "2"]}], " ", "+", " ", 
       RowBox[{
        SubscriptBox["ik", "x"], "x"}], " ", "+", " ", 
       RowBox[{
        SubscriptBox["ik", "y"], "y"}]}], "]"}]}]}], "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gauss", "[", 
      RowBox[{
      "coords_", ",", "A_", ",", "x0_", ",", "y0_", ",", "\[Sigma]x_", ",", 
       "\[Sigma]y_", ",", "kx_", ",", "ky_"}], "]"}], ":=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"A", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"coords", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "x0"}], ")"}], 
              "/", "\[Sigma]x"}], ")"}], "^", "2"}]}], "-", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"coords", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", "y0"}], ")"}], 
              "/", "\[Sigma]y"}], ")"}], "^", "2"}]}], "+", 
          RowBox[{"I", "*", "kx", "*", 
           RowBox[{"coords", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "+", 
          RowBox[{"I", "*", "kx", "*", 
           RowBox[{"coords", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n"}]}]], "Code",
 CellChangeTimes->{{3.73410915238778*^9, 3.73410920705758*^9}, {
  3.7341093223545284`*^9, 3.7341096689002743`*^9}, {3.7341112423524804`*^9, 
  3.7341112730738297`*^9}, {3.7341114435341845`*^9, 
  3.734111515021747*^9}},ExpressionUUID->"a9216b01-6504-4af1-8f6b-\
8a04af8ab287"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"snkend", "[", 
     RowBox[{"coords_", ",", "frac_"}], "]"}], ":=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"coords", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_"}], "}"}], "/;", " ", 
       RowBox[{"y", "\[GreaterEqual]", " ", 
        RowBox[{"frac", "*", 
         RowBox[{"Min", "[", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], 
          "]"}]}]}]}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"srcend", "[", 
     RowBox[{"coords_", ",", "frac_"}], "]"}], ":=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"coords", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_"}], "}"}], "/;", " ", 
       RowBox[{"y", "\[GreaterEqual]", " ", 
        RowBox[{"frac", "*", 
         RowBox[{"Min", "[", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}], 
          "]"}]}]}]}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"normalise", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sum", " ", "=", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"[", "x", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", "norm", 
      ",", "output"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"norm", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1.", "/", "sum"}], "]"}]}], ";", "\n", 
     RowBox[{"output", "=", 
      RowBox[{"norm", "*", "x"}]}]}]}], "\n", "]"}]}]}], "Code",
 CellChangeTimes->{{3.7346934090731573`*^9, 3.7346934227384715`*^9}, {
  3.734693495713483*^9, 3.7346934969774666`*^9}, {3.7346957231227007`*^9, 
  3.7346958484650145`*^9}, {3.734727401669911*^9, 3.7347274034166527`*^9}, {
  3.734863186042436*^9, 
  3.734863190617777*^9}},ExpressionUUID->"ec8b480e-7721-4947-8099-\
7f4e08ba623b"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.7341157398814616`*^9},ExpressionUUID->"92713a44-f2b2-46fb-b1b3-\
4e9fab8b08fc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Marching Squares Algorithm", "Section",
 CellChangeTimes->{{3.720474932100095*^9, 
  3.7204749574445443`*^9}},ExpressionUUID->"a768d014-a797-4b7d-bd27-\
fe50b6ac7db4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Construction", " ", "of", " ", "a", " ", "bew", " ", "marching", " ", 
    "squares", " ", "algorithm"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "All", " ", "possible", " ", "binary", " ", "values", " ", "of", " ", "a", 
    " ", "2", "x2", " ", "Grid"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"mat", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "1."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "1."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "1."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "1."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "1."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "0."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "1."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "1."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "1."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "0."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "1."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "1."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "1."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "1."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "1."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "0."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "1."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "1."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "1."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "0."}], "}"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Equate", " ", "the", " ", "cases", " ", "of", " ", "the", " ", "above", 
     " ", "matrix", " ", "positions", " ", "to", " ", "a", " ", "unique", " ",
      "number"}], " ", "*)"}], "\t\t", "\n", 
   RowBox[{
    RowBox[{"cases", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
       "8", ",", "8", ",", "7", ",", "6", ",", "5", ",", "4", ",", "3", ",", 
       "2", ",", "1"}], "}"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "which", " ", "case", " ", "our", " ", "2", "x2", " ", 
     "binary", " ", "grid", " ", "is", " ", "from", " ", "the", " ", "list", 
     " ", "of", " ", "all", " ", "possible", " ", "cases"}], " ", "*)"}], 
   "\t\t", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"imfrom3", "[", "mat2_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"imfrom3", "[", "mat2", "]"}], " ", "=", " ", 
      RowBox[{"Extract", "[", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"cases", ",", 
          RowBox[{"Position", "[", 
           RowBox[{"mat", ",", "mat2"}], "]"}]}], "]"}], ",", "1"}], 
       "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Linear", " ", "interpolation", " ", "subfunctions"}], ",", " ", 
     RowBox[{
     "our", " ", "real", " ", "eigenfunction", " ", "data", " ", "in", " ", 
      "the", " ", "2", "x2", " ", "grids", " ", "are", " ", "ordered", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Psi]1", ",", "\[Psi]2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Psi]3", ",", "\[Psi]4"}], "}"}]}], "}"}]}]}], "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lincass1", "[", 
      RowBox[{"\[Psi]1_", ",", "\[Psi]3_", ",", "v_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"lincass1", "[", 
       RowBox[{"\[Psi]1", ",", "\[Psi]3", ",", "v"}], "]"}], "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "-", "\[Psi]3"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Psi]1", "-", "\[Psi]3"}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lincass2", "[", 
      RowBox[{"\[Psi]2_", ",", "\[Psi]4_", ",", "v_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"lincass2", "[", 
       RowBox[{"\[Psi]2", ",", "\[Psi]4", ",", "v"}], "]"}], "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "-", "\[Psi]4"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Psi]2", "-", "\[Psi]4"}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lincass3", "[", 
      RowBox[{"\[Psi]1_", ",", "\[Psi]2_", ",", "v_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"lincass3", "[", 
       RowBox[{"\[Psi]1", ",", "\[Psi]2", ",", "v"}], "]"}], "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "-", "\[Psi]2"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Psi]1", "-", "\[Psi]2"}], ")"}]}]}]}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lincass4", "[", 
      RowBox[{"\[Psi]3_", ",", "\[Psi]4_", ",", "v_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"lincass4", "[", 
       RowBox[{"\[Psi]3", ",", "\[Psi]4", ",", "v"}], "]"}], "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "-", "\[Psi]4"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Psi]3", "-", "\[Psi]4"}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lincass5", "[", 
      RowBox[{"\[Psi]2_", ",", "\[Psi]3_", ",", "v_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"lincass5", "[", 
       RowBox[{"\[Psi]2", ",", "\[Psi]3", ",", "v"}], "]"}], "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "-", "\[Psi]3"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Psi]2", "-", "\[Psi]3"}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lincass6", "[", 
      RowBox[{"\[Psi]1_", ",", "\[Psi]4_", ",", "v_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"lincass6", "[", 
       RowBox[{"\[Psi]1", ",", "\[Psi]4", ",", "v"}], "]"}], "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"v", "-", "\[Psi]4"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Psi]1", "-", "\[Psi]4"}], ")"}]}]}]}], ";"}], " ", "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Linear", " ", "interpolation", " ", 
     RowBox[{"function", ":", " ", 
      RowBox[{
      "for", " ", "our", " ", "original", " ", "data", " ", "in", " ", "the", 
       " ", "2", "x2", " ", "grid", " ", "look", " ", "at", " ", "each", " ", 
       "case", " ", "and", " ", "work", " ", "out", " ", "linear", " ", 
       "interpolated", " ", "points", " ", "to", " ", "where", " ", "our", 
       " ", "contour", " ", "value", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "0.5"}], "\[Psi]"}], ")"}], " ", 
       "are", " ", "for", " ", "each", " ", "set", " ", "of", " ", "points", 
       " ", "for", " ", "each", " ", "contour", " ", "case"}]}]}], "*)"}], 
   " ", "\n", 
   RowBox[{
    RowBox[{"linint", "[", 
     RowBox[{
     "x2grid_", ",", " ", "i_", ",", "j_", ",", " ", "case_", ",", 
      "endpoint_", ",", "val_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Psi]1", " ", "=", " ", 
         RowBox[{"x2grid", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"\[Psi]2", " ", "=", " ", 
         RowBox[{"x2grid", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"\[Psi]3", " ", "=", " ", 
         RowBox[{"x2grid", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"\[Psi]4", " ", "=", " ", 
         RowBox[{"x2grid", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"jp", " ", "=", " ", 
         RowBox[{"endpoint", "-", "j"}]}], ",", " ", 
        RowBox[{"out", " ", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", "\n", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"case", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{"out", " ", "=", 
          RowBox[{"{", "}"}]}], ",", "\n", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"case", " ", "\[Equal]", " ", "2"}], ",", "\n", "\t    ", 
           RowBox[{"out", " ", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"jp", "-", "1", "+", 
                 RowBox[{"lincass1", "[", 
                  RowBox[{"\[Psi]1", ",", "\[Psi]3", ",", "val"}], "]"}]}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", "1", "-", 
                 RowBox[{"lincass4", "[", 
                  RowBox[{"\[Psi]3", ",", "\[Psi]4", ",", "val"}], "]"}]}], 
                ",", 
                RowBox[{"jp", "-", "1"}]}], "}"}]}], "}"}]}], ",", "\n", 
           "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"case", " ", "\[Equal]", " ", "3"}], ",", " ", 
             RowBox[{"out", " ", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"i", "+", "1", "-", 
                   RowBox[{"lincass4", "[", 
                    RowBox[{"\[Psi]3", ",", "\[Psi]4", ",", "val"}], "]"}]}], 
                  ",", 
                  RowBox[{"jp", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", 
                  RowBox[{
                   RowBox[{"lincass2", "[", 
                    RowBox[{"\[Psi]2", ",", "\[Psi]4", ",", "val"}], "]"}], 
                   "+", "jp", "-", "1"}]}], "}"}]}], "}"}]}], ",", "\n", 
             "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"case", " ", "\[Equal]", " ", "4"}], ",", "\n", 
               "\t\t\t\t", 
               RowBox[{"out", " ", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"jp", "-", "1", "+", 
                    RowBox[{"lincass1", "[", 
                    RowBox[{"\[Psi]1", ",", "\[Psi]3", ",", "val"}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"lincass2", "[", 
                    RowBox[{"\[Psi]2", ",", "\[Psi]4", ",", "val"}], "]"}], 
                    "+", "jp", "-", "1"}]}], "}"}]}], "}"}]}], ",", "\n", 
               "\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"case", " ", "\[Equal]", " ", "5"}], ",", "\n", 
                 "\t\t\t\t    ", 
                 RowBox[{"out", " ", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1", "-", 
                    RowBox[{"lincass3", "[", 
                    RowBox[{"\[Psi]1", ",", "\[Psi]2", ",", "val"}], "]"}]}], 
                    ",", "jp"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"lincass2", "[", 
                    RowBox[{"\[Psi]2", ",", "\[Psi]4", ",", "val"}], "]"}], 
                    "+", "jp", "-", "1"}]}], "}"}]}], "}"}]}], ",", "\n", 
                 "\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"case", " ", "\[Equal]", " ", "6"}], ",", "\n", 
                   "\t\t\t\t\t\t", 
                   RowBox[{"out", " ", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"jp", "-", "1", "+", 
                    RowBox[{"lincass1", "[", 
                    RowBox[{"\[Psi]1", ",", "\[Psi]3", ",", "val"}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1", "-", 
                    RowBox[{"lincass4", "[", 
                    RowBox[{"\[Psi]3", ",", "\[Psi]4", ",", "val"}], "]"}]}], 
                    ",", 
                    RowBox[{"jp", "-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"lincass2", "[", 
                    RowBox[{"\[Psi]2", ",", "\[Psi]4", ",", "val"}], "]"}], 
                    "+", "jp", "-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1", "-", 
                    RowBox[{"lincass3", "[", 
                    RowBox[{"\[Psi]1", ",", "\[Psi]2", ",", "val"}], "]"}]}], 
                    ",", "jp"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"case", " ", "\[Equal]", " ", "7"}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"out", " ", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1", "-", 
                    RowBox[{"lincass3", "[", 
                    RowBox[{"\[Psi]1", ",", "\[Psi]2", ",", "val"}], "]"}]}], 
                    ",", "jp"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1", "-", 
                    RowBox[{"lincass4", "[", 
                    RowBox[{"\[Psi]3", ",", "\[Psi]4", ",", "val"}], "]"}]}], 
                    ",", 
                    RowBox[{"jp", "-", "1"}]}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"case", " ", "\[Equal]", " ", "8"}], ",", "\n", 
                    "\t\t\t\t\t\t\t     ", 
                    RowBox[{"out", " ", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"jp", "-", "1", "+", 
                    RowBox[{"lincass1", "[", 
                    RowBox[{"\[Psi]1", ",", "\[Psi]3", ",", "val"}], 
                    "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1", "-", 
                    RowBox[{"lincass3", "[", 
                    RowBox[{"\[Psi]1", ",", "\[Psi]2", ",", "val"}], "]"}]}], 
                    ",", "jp"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t     ", 
                    RowBox[{"{", "}"}]}], "\n", "\t\t\t\t\t\t\t   ", "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", 
                  "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", 
              "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], "\n", 
        "\t", "]"}], ";", "\n", "\t", "out"}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "function", " ", "connects", " ", "adjacent", " ", "points", 
     " ", "together", " ", "from", " ", "the", " ", "Marching", " ", 
     "Squares", " ", "Algorithm"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Contour", "[", "points_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "contour", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"contour", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\n", 
       RowBox[{"Do", "[", "\n", " ", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"contour", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"points", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"points", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], "\n",
           "]"}], ",", "\n", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "points", "]"}], "-", "1"}], ",", "2"}], 
          "}"}]}], "]"}], ";", "\n", "contour"}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Linear", " ", "Interpolated", " ", "Marching", " ", "Squares", " ", 
     "function", " ", "for", " ", "finding", " ", "contours", " ", "at", " ", 
     "a", " ", "set", " ", "value", "*", "\[Psi]"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"marchingSquares3", "[", 
     RowBox[{"data_", ",", "value_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "indextable", ",", "evec", ",", "vals", ",", "binarytable", ",", 
        "endpoint2", ",", "testmat", ",", "contour", ",", "origi", ",", 
        "dat2", ",", "dat3", ",", "points"}], "}"}], ",", "\n", "\n", "\t", 
      RowBox[{
       RowBox[{"indextable", " ", "=", " ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"evec", " ", "=", " ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"value", "*", 
         RowBox[{"Max", "[", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], 
          "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"binarytable", " ", "=", " ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], " ", "\[GreaterEqual]", 
             "   ", "vals"}], ",", "1", ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\n", "\t", 
       RowBox[{"endpoint2", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"indextable", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "indextable", "]"}]}], "}"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"testmat", " ", "=", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{"binarytable", ",", 
          RowBox[{"endpoint2", "+", "1"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"contour", " ", "=", " ", 
        RowBox[{"Image", "[", "testmat", "]"}]}], ";", "\n", "\t", 
       RowBox[{"origi", " ", "=", " ", 
        RowBox[{"Image", "[", 
         RowBox[{"Partition", "[", 
          RowBox[{"evec", ",", 
           RowBox[{"endpoint2", "+", "1"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
       RowBox[{"dat2", " ", "=", " ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PixelValue", "[", 
                 RowBox[{"contour", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"endpoint2", "+", "1", "-", "j"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"PixelValue", "[", 
                 RowBox[{"contour", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"endpoint2", "+", "1", "-", "j"}]}], "}"}]}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PixelValue", "[", 
                 RowBox[{"contour", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"endpoint2", "-", "j"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"PixelValue", "[", 
                 RowBox[{"contour", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"endpoint2", "-", "j"}]}], "}"}]}], "]"}]}], 
               "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"endpoint2", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"endpoint2", "-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"dat3", " ", "=", " ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PixelValue", "[", 
                 RowBox[{"origi", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"endpoint2", "+", "1", "-", "j"}]}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"PixelValue", "[", 
                 RowBox[{"origi", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"endpoint2", "+", "1", "-", "j"}]}], "}"}]}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PixelValue", "[", 
                 RowBox[{"origi", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "+", "i"}], ",", 
                    RowBox[{"endpoint2", "-", "j"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"PixelValue", "[", 
                 RowBox[{"origi", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"2", "+", "i"}], ",", 
                    RowBox[{"endpoint2", "-", "j"}]}], "}"}]}], "]"}]}], 
               "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"endpoint2", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"endpoint2", "-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "\n", "\t", 
       RowBox[{"points", " ", "=", " ", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"linint", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"dat3", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "i", ",", "j", 
              ",", 
              RowBox[{"imfrom3", "[", 
               RowBox[{
                RowBox[{"dat2", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], ",", 
              "endpoint2", ",", "vals"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "dat2", "]"}], "-", "1"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{
             RowBox[{"Length", "[", "dat2", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"points", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"points", ",", "2"}], "]"}]}]}]}], "\n", "\n", "]"}]}], "\n",
    "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "TO", " ", "SHOW", " ", "GRAPHICALLY", " ", "THE", " ", "CONTOUR", " ", 
      "DO", " ", 
      RowBox[{"THIS", ":", " ", "\n", "\n", 
       RowBox[{"Graphics", "[", 
        RowBox[{"Contour", "[", "points", "]"}], "]"}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"where", "\n", "points"}], " ", "=", " ", 
      RowBox[{"marchingSquares2", "[", 
       RowBox[{"data", ",", "value"}], "]"}]}], ";"}], "\n", "\n", "\n", 
    "*)"}]}]}]], "Code",
 CellChangeTimes->{
  3.7204749836330423`*^9, {3.720475814536567*^9, 3.7204758149685917`*^9}, {
   3.7207832109114604`*^9, 3.72078328713482*^9}, 3.72079107428922*^9, {
   3.720792728162816*^9, 3.720792831057701*^9}, {3.7208173698492403`*^9, 
   3.7208175299894*^9}, {3.72081768227711*^9, 3.7208176913496284`*^9}, {
   3.7208177398634033`*^9, 3.7208178565660787`*^9}, {3.720818865366779*^9, 
   3.7208189509826756`*^9}, {3.720818984006564*^9, 3.7208190568877335`*^9}, {
   3.7208193376707926`*^9, 3.7208193479913836`*^9}, 3.720819410646967*^9, {
   3.7208202409684587`*^9, 3.720820241430485*^9}, {3.720820341928233*^9, 
   3.7208203425822706`*^9}, {3.721433194368041*^9, 3.7214332370644827`*^9}, {
   3.721433395845565*^9, 3.7214333979416847`*^9}, {3.7214338885687466`*^9, 
   3.721433888935768*^9}, {3.7214747243416667`*^9, 3.721475049838284*^9}, {
   3.722262929244338*^9, 3.7222629526976795`*^9}, {3.722263001452468*^9, 
   3.72226303085715*^9}, {3.7231520541809425`*^9, 3.723152066339638*^9}, {
   3.759268993785731*^9, 3.7592691243945866`*^9}, {3.7592692162470446`*^9, 
   3.7592692246634607`*^9}},ExpressionUUID->"c69d9a10-c59a-4aca-8b28-\
0326f270d6d5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.724032743044552*^9, 
  3.724032744784561*^9}},ExpressionUUID->"23d56460-92d9-493c-9897-\
c5c4df854cda"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7337524161159534`*^9, 3.7337524214371696`*^9}, {
  3.734109178530512*^9, 
  3.734109179218097*^9}},ExpressionUUID->"c3660a23-885d-492b-bb4b-\
904ea76aad24"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Box Counting Algorithm and Fractal Dimension", "Section",
 CellChangeTimes->{{3.7204750451245594`*^9, 
  3.72047505440409*^9}},ExpressionUUID->"d69df91c-a67b-43f3-83dc-\
e75601fc191f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Produces", " ", "a", " ", "grid", " ", "over", " ", "the", " ", "image", 
    " ", "of", " ", "the", " ", "contour"}], "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"grid2", "[", 
     RowBox[{"lmax_", ",", "eps_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", "=", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"l1", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"lmax", ",", "y"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "0", ",", "lmax", ",", " ", 
             RowBox[{"lmax", "/", "eps"}]}], "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"l1", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "lmax"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "lmax", ",", " ", 
             RowBox[{"lmax", "/", "eps"}]}], "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "l1"}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"grid3", "[", 
     RowBox[{"lmax_", ",", "eps_", ",", "sx_", ",", "sy_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", "=", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"l1", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"sx", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"lmax", ",", "y"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "sy", ",", "lmax", ",", " ", 
             RowBox[{"lmax", "/", "eps"}]}], "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"l1", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "sy"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "lmax"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "sx", ",", "lmax", ",", " ", 
             RowBox[{"lmax", "/", "eps"}]}], "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "l1"}]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "function", " ", "produces", " ", "boxes", " ", "and", " ", 
     "counts", " ", "the", " ", "number", " ", "which", " ", "are", " ", 
     RowBox[{"filled", ".", " ", "It"}], " ", "produces", " ", "a", " ", 
     "number", " ", "of", " ", "boxes", " ", "and", " ", "their", " ", 
     "positions"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"PointSearch", "[", 
     RowBox[{"lmax_", ",", "eps_", ",", "points_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "deltaeps", ",", "xgmin", ",", "xgmax", ",", "ygmin", ",", "ygmax", 
        ",", "occupied", ",", 
        RowBox[{"tpoints", " ", "=", " ", "points"}], ",", " ", 
        RowBox[{"data", " ", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"deltaeps", "=", " ", 
        RowBox[{"lmax", "/", "eps"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"xgmin", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"xgmax", "=", 
        RowBox[{"xgmin", "+", "deltaeps"}]}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"ygmin", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"ygmax", "=", 
        RowBox[{"ygmin", "+", "deltaeps"}]}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"occupied", "=", 
        RowBox[{"{", "}"}]}], ";", "\n", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"-", "detect"}]}], " ", "the", " ", "occupied", " ", 
          RowBox[{"squares", "--"}]}], "-"}], "*)"}], "\n", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Do", "[", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xgmin", "\[LessEqual]", 
                   RowBox[{"tpoints", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "<", " ", 
                   "xgmax"}], "&&", 
                  RowBox[{"ygmin", "\[LessEqual]", 
                   RowBox[{"tpoints", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", " ", 
                   "ygmax"}]}], ",", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"occupied", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Polygon", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xgmin", ",", "ygmin"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xgmax", ",", "ygmin"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xgmax", ",", "ygmax"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xgmin", ",", "ygmax"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xgmin", ",", "ygmin"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], ";", "\n", "\t\t\t\t\t", 
                  RowBox[{"tpoints", " ", "=", " ", 
                   RowBox[{"Drop", "[", 
                    RowBox[{"tpoints", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"Return", "[", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}],
                ",", "\n", "\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "tpoints", "]"}]}], "}"}]}], "\n", 
              "\t\t\t\t", "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"xgmin", "=", 
              RowBox[{"xgmin", "+", "deltaeps"}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"xgmax", "=", 
              RowBox[{"xgmin", "+", "deltaeps"}]}]}], ",", "\n", "\t\t\t", 
            RowBox[{"{", 
             RowBox[{"jx", ",", "1", ",", "eps"}], "}"}]}], "\n", "\t\t\t", 
           "]"}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"xgmin", "=", "0"}], ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{"xgmax", "=", 
           RowBox[{"xgmin", "+", "deltaeps"}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"ygmin", "=", 
           RowBox[{"ygmin", "+", "deltaeps"}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"ygmax", "=", 
           RowBox[{"ygmin", "+", "deltaeps"}]}]}], ",", "\n", "\t\t", 
         RowBox[{"{", 
          RowBox[{"jy", ",", "1", ",", "eps"}], "}"}]}], "\n", "\t", "]"}], 
       ";", "\n", "\t", "\[IndentingNewLine]", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"data", ",", 
         RowBox[{"{", 
          RowBox[{"deltaeps", ",", 
           RowBox[{"Length", "[", "occupied", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", "occupied"}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"PointSearch2", "[", 
     RowBox[{
     "lmax_", ",", "eps_", ",", "points_", ",", "shiftx_", ",", "shifty_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "deltaeps", ",", "xgmin", ",", "xgmax", ",", "ygmin", ",", "ygmax", 
        ",", "occupied", ",", 
        RowBox[{"tpoints", " ", "=", " ", "points"}], ",", " ", 
        RowBox[{"data", " ", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"deltaeps", "=", " ", 
        RowBox[{"lmax", "/", "eps"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"xgmin", "=", "shiftx"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"xgmax", "=", 
        RowBox[{"xgmin", "+", "deltaeps"}]}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"ygmin", "=", "shifty"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"ygmax", "=", 
        RowBox[{"ygmin", "+", "deltaeps"}]}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"occupied", "=", 
        RowBox[{"{", "}"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"-", "detect"}]}], " ", "the", " ", "occupied", " ", 
          RowBox[{"squares", "--"}]}], "-"}], "*)"}], "\n", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Do", "[", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xgmin", "\[LessEqual]", 
                   RowBox[{"tpoints", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "<", " ", 
                   "xgmax"}], "&&", 
                  RowBox[{"ygmin", "\[LessEqual]", 
                   RowBox[{"tpoints", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", " ", 
                   "ygmax"}]}], ",", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"occupied", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Polygon", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xgmin", ",", "ygmin"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xgmax", ",", "ygmin"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xgmax", ",", "ygmax"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xgmin", ",", "ygmax"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xgmin", ",", "ygmin"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\t\t\t\t\t", 
                  RowBox[{"Return", "[", "]"}]}]}], "\n", "\t\t\t\t", "]"}], 
               ",", "\n", "\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "tpoints", "]"}]}], "}"}]}], "]"}], 
             ";", "\[IndentingNewLine]", "\t\t\t\t", 
             RowBox[{"xgmin", "=", 
              RowBox[{"xgmin", "+", "deltaeps"}]}], ";", 
             "\[IndentingNewLine]", "\t\t\t\t", 
             RowBox[{"xgmax", "=", 
              RowBox[{"xgmin", "+", "deltaeps"}]}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"jx", ",", "1", ",", "eps"}], "}"}]}], "\n", "\t\t\t", 
           "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"xgmin", "=", "shiftx"}], ";", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"xgmax", "=", 
           RowBox[{"xgmin", "+", "deltaeps"}]}], ";", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"ygmin", "=", 
           RowBox[{"ygmin", "+", "deltaeps"}]}], ";", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"ygmax", "=", 
           RowBox[{"ygmin", "+", "deltaeps"}]}]}], ",", "\n", "\t\t\t", 
         RowBox[{"{", 
          RowBox[{"jy", ",", "1", ",", "eps"}], "}"}]}], "\n", "\t\t", "]"}], 
       ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"data", ",", 
         RowBox[{"{", 
          RowBox[{"deltaeps", ",", 
           RowBox[{"Length", "[", "occupied", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", "occupied"}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"ns2", "[", 
     RowBox[{
     "endpoint_", ",", "\[Epsilon]_", ",", "points_", ",", "shiftx_", ",", 
      "shifty_"}], "]"}], ":=", " ", 
    RowBox[{"Length", "[", 
     RowBox[{"PointSearch2", "[", 
      RowBox[{
      "endpoint", ",", "\[Epsilon]", ",", "points", ",", "shiftx", ",", 
       "shifty"}], "]"}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"marker1", " ", "=", " ", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "draw", " ", "the", " ", "boxcount", " ", "for", " ", "a", " ", "given", 
     " ", "iteration"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"drawboxcount", "[", 
     RowBox[{
     "endpoint_", ",", "\[Epsilon]_", ",", "points_", ",", "contour_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSearch", "[", 
        RowBox[{"endpoint", ",", "\[Epsilon]", ",", "points"}], "]"}], ",", 
       RowBox[{"grid2", "[", 
        RowBox[{"endpoint", ",", "\[Epsilon]"}], "]"}], ",", "contour"}], 
      "}"}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"drawboxcounts", "[", 
     RowBox[{
     "endpoint_", ",", "\[Epsilon]_", ",", "points_", ",", "contour_", ",", 
      "sx_", ",", "sy_"}], "]"}], ":=", " ", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSearch2", "[", 
        RowBox[{
        "endpoint", ",", "\[Epsilon]", ",", "points", ",", "sx", ",", "sy"}], 
        "]"}], ",", 
       RowBox[{"grid3", "[", 
        RowBox[{"endpoint", ",", "\[Epsilon]", ",", "sx", ",", "sy"}], "]"}], 
       ",", "contour"}], "}"}], "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"draw", " ", "the", " ", "boxcount", " ", "and", " ", "points"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"drawboxcount2", "[", 
     RowBox[{
     "endpoint_", ",", "\[Epsilon]_", ",", "points_", ",", "contour_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSearch", "[", 
          RowBox[{"endpoint", ",", "\[Epsilon]", ",", "points"}], "]"}], ",", 
         RowBox[{"grid2", "[", 
          RowBox[{"endpoint", ",", "\[Epsilon]"}], "]"}], ",", "contour"}], 
        "}"}], "]"}], ",", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"points", ",", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"marker1", ",", "0.003"}], "}"}]}]}], "]"}]}], "]"}]}], 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Find", " ", "N", 
     RowBox[{"(", "s", ")"}], " ", "for", " ", "a", " ", "given", " ", 
     "\[Epsilon]"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ns", "[", 
     RowBox[{"endpoint_", ",", "\[Epsilon]_", ",", "points_"}], "]"}], ":=", 
    " ", 
    RowBox[{"Length", "[", 
     RowBox[{"PointSearch", "[", 
      RowBox[{"endpoint", ",", "\[Epsilon]", ",", "points"}], "]"}], "]"}]}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{"BC0", "[", 
     RowBox[{"contour_", ",", " ", "n_", ",", "endpoint_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "div", ",", " ", "num", ",", " ", "squares", ",", " ", "finals", ",", 
        " ", "key", ",", " ", "condition", ",", " ", "out1", ",", " ", "out2",
         ",", "j", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"num", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"div", "=", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{"i", "*", 
                RowBox[{"endpoint", "/", "n"}]}], "]"}], ",", " ", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}], "*", 
                RowBox[{"endpoint", "/", "n"}]}], "]"}], ",", " ", 
              RowBox[{"N", "[", 
               RowBox[{"j", "*", 
                RowBox[{"endpoint", "/", "n"}]}], "]"}], ",", " ", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "+", "1"}], ")"}], "*", 
                RowBox[{"endpoint", "/", "n"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "0", ",", " ", 
              RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "0", ",", " ", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"squares", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"finals", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", " ", 
            RowBox[{"j", "\[LessEqual]", " ", "n"}], ",", " ", 
            RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"key", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"contour", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[GreaterEqual]", 
                   " ", 
                   RowBox[{"div", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], "&&", 
                  " ", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "\[LessEqual]", "  ", 
                   RowBox[{"div", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}]}], "&&", 
                  " ", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "\[GreaterEqual]", 
                   " ", 
                   RowBox[{"div", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}]}], "&&", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "\[LessEqual]", "  ", 
                   RowBox[{"div", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "4"}], "]"}], "]"}]}]}], 
                 "&"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"condition", "=", 
              RowBox[{"key", "\[Equal]", 
               RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
              "condition", ",", "\[IndentingNewLine]", "\t\t\t\t", "Nothing", 
               ",", " ", "\[IndentingNewLine]", "\t\t\t\t", 
               RowBox[{
                RowBox[{"num", "=", 
                 RowBox[{"num", "+", "1"}]}], ";", " ", "\[IndentingNewLine]",
                 "\t\t\t\t", 
                RowBox[{"squares", "=", 
                 RowBox[{"Union", "[", 
                  RowBox[{"squares", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"div", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"div", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}]}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"div", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"div", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "4"}], "]"}], "]"}]}], 
                    "}"}]}], "}"}], "}"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\t\t\t\t", 
                RowBox[{"finals", "=", 
                 RowBox[{"Union", "[", 
                  RowBox[{"finals", ",", " ", 
                   RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", "]"}], 
             ";"}]}], "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"out1", ",", " ", "out2"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{"num", ",", " ", "squares"}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BC", "[", 
      RowBox[{"contour_", ",", " ", "n_", ",", "endpoint_"}], "]"}], ":=", 
     " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "num1", ",", " ", "squares1", ",", " ", "i", ",", " ", "touchneighs", 
         ",", " ", "diagneighs", ",", "notintheedges", ",", " ", "squarei", 
         ",", " ", "upright", ",", "ur", ",", " ", "upleft", ",", "ul", ",", 
         " ", "downright", ",", "dr", ",", " ", "downleft", ",", "dl", ",", 
         " ", "up", ",", " ", "down", ",", " ", "left", ",", " ", "right", 
         ",", " ", "new", ",", " ", "out1", ",", " ", "out2"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"num1", ",", " ", "squares1"}], "}"}], "=", 
         RowBox[{"BC0", "[", 
          RowBox[{"contour", ",", " ", "n", ",", "endpoint"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"i", "<", 
           RowBox[{"Length", "[", "squares1", "]"}]}], ",", " ", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"squarei", "=", 
            RowBox[{"squares1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"upright", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", " ", 
              RowBox[{"squarei", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"ur", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"squares1", ",", " ", "upright"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"upleft", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", " ", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"ul", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"squares1", ",", " ", "upleft"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"downright", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "&"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"dr", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"squares1", ",", "downright"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"downleft", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", " ", 
              RowBox[{"squarei", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"dl", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"squares1", ",", "downleft"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"diagneighs", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"squares1", ",", " ", 
              RowBox[{"Through", "@*", " ", 
               RowBox[{"Or", "[", 
                RowBox[{
                "upright", ",", " ", "upleft", ",", " ", "downright", ",", 
                 " ", "downleft"}], "]"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"up", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", " ", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"down", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", " ", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "&"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"left", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"right", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "&&", " ", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[Equal]", " ", 
               RowBox[{"squarei", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"touchneighs", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"squares1", ",", " ", 
              RowBox[{"Through", "@*", " ", 
               RowBox[{"Or", "[", 
                RowBox[{
                "up", ",", " ", "down", ",", "left", ",", " ", "right"}], 
                "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "touchneighs", "]"}], "+", " ", 
               RowBox[{"Length", "[", "diagneighs", "]"}]}], "<", "3"}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "diagneighs", "]"}], "\[Equal]", "0"}],
                ",", "\n", "\t\t\t\t\t ", "Nothing", ",", 
               "\[IndentingNewLine]", "\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "diagneighs", "]"}], "\[Equal]", 
                  "1"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"squares1", "=", 
                  RowBox[{"Union", "[", 
                   RowBox[{"squares1", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"squarei", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"squarei", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], 
                    "}"}]}], "}"}], "}"}]}], "]"}]}], ",", " ", 
                 "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "diagneighs", "]"}], "\[Equal]", 
                    "2"}], ",", " ", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"squarei", "\[Equal]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], 
                    ",", "  ", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"squares1", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{"squares1", ",", "  ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"squarei", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"squarei", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], 
                    "}"}]}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"squarei", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"squarei", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], 
                    "}"}]}], "}"}]}], "}"}]}], "]"}]}], " ", ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"squares1", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{"squares1", ",", "  ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}], 
                    "}"}]}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "diagneighs", "]"}], "\[Equal]", 
                    "3"}], ",", " ", "\[IndentingNewLine]", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"squares1", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{"squares1", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    RowBox[{"diagneighs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "2"}]}], 
                    "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"squares1", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{"squares1", ",", " ", 
                    RowBox[{"{", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                  "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
              "]"}], ",", "\[IndentingNewLine]", "\t\t\t\t", "Nothing"}], 
            "\n", "\t\t\t", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"i", "++"}]}]}], "\n", "\t", "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"out1", ",", " ", "out2"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "squares1", "]"}], ",", " ", "squares1"}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.720475109687252*^9, 3.7204751271582513`*^9}, {
   3.720475200020419*^9, 3.720475284230235*^9}, 3.7204753483419027`*^9, {
   3.720475626133791*^9, 3.72047564010359*^9}, {3.7207844112621164`*^9, 
   3.720784414445299*^9}, {3.7207928621604805`*^9, 3.720792869902923*^9}, {
   3.720813252080717*^9, 3.7208132700497446`*^9}, {3.7208135154577813`*^9, 
   3.7208135348178887`*^9}, {3.7208137238577013`*^9, 
   3.7208137417287235`*^9}, {3.7208138286426945`*^9, 3.720813876673442*^9}, {
   3.7214070306515617`*^9, 3.721407042635247*^9}, {3.72140710633189*^9, 
   3.7214071318763514`*^9}, {3.7214071941559134`*^9, 3.721407218076282*^9}, {
   3.7214076341440797`*^9, 3.721407636268201*^9}, {3.72140794361278*^9, 
   3.7214079561244955`*^9}, {3.721408088477066*^9, 3.721408111788399*^9}, {
   3.721475093514782*^9, 3.721475160826632*^9}, {3.722263051460328*^9, 
   3.7222630518443503`*^9}, {3.722263083465159*^9, 3.722263171532196*^9}, {
   3.7222669870514317`*^9, 3.7222669891645527`*^9}, {3.723454471958858*^9, 
   3.7234544730469203`*^9}, 3.723454503415657*^9, {3.723454560422918*^9, 
   3.723454587286454*^9}, 3.7234546639278383`*^9, {3.7234548017027187`*^9, 
   3.7234548027747793`*^9}, {3.723454893783985*^9, 3.723454927174895*^9}, {
   3.7234568729991894`*^9, 3.7234569117514057`*^9}, {3.723456958236065*^9, 
   3.7234570129031916`*^9}, {3.723457055402622*^9, 3.723457086616408*^9}, {
   3.7234572259313765`*^9, 3.7234572893510036`*^9}, {3.723457323752971*^9, 
   3.7234573504404974`*^9}, {3.7234573838634095`*^9, 3.7234575185821147`*^9}, 
   3.723457578135521*^9, {3.7234576384579716`*^9, 3.723457640761103*^9}, {
   3.723458433433441*^9, 3.723458433945471*^9}, {3.723493079211727*^9, 
   3.723493109161215*^9}, {3.723493701211169*^9, 3.7234937188993196`*^9}, {
   3.723493818684597*^9, 3.723493823316042*^9}, {3.7234939242547035`*^9, 
   3.7234939280789347`*^9}, {3.7235812980048113`*^9, 3.723581309955495*^9}, {
   3.723590430686245*^9, 3.7235904327262545`*^9}, {3.7235904715244665`*^9, 
   3.7235905012196226`*^9}, {3.7235905331898236`*^9, 3.723590533534825*^9}, {
   3.723590754183514*^9, 3.7235907907492504`*^9}, {3.72364715049483*^9, 
   3.7236471566378508`*^9}, {3.7592692471497464`*^9, 
   3.7592695119312325`*^9}, {3.7592698781078606`*^9, 
   3.7592703240742435`*^9}},ExpressionUUID->"0272427a-4029-4972-8c19-\
e4b35dd18f0f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"boxtable", "[", 
    RowBox[{"endpoint_", ",", " ", "\[Epsilon]_"}], "]"}], ":=", " ", 
   RowBox[{"Block", " ", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"endpoint", "/", "\[Epsilon]"}]}], ",", " ", "output"}], 
      "}"}], ",", "\n", "\n", "\t", 
     RowBox[{"output", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "*", "s"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "s"}], ",", 
              RowBox[{"j", "*", "s"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "+", "1"}], ")"}], "*", "s"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"\[Epsilon]", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"\[Epsilon]", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}]}], "\n", "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"altboxcount", "[", 
    RowBox[{"points_", ",", "\[Epsilon]_", ",", "endpoint_"}], "]"}], ":=", 
   " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"box", " ", "=", " ", 
        RowBox[{"boxtable", "[", 
         RowBox[{"endpoint", ",", "\[Epsilon]"}], "]"}]}], ",", "ntable", ",",
        "pointst", ",", "n", ",", "sum"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"pointst", " ", "=", " ", "points"}], ";", "\n", "\t", 
      RowBox[{"SetSharedVariable", "[", "pointst", "]"}], ";", "\n", "\t", 
      RowBox[{"SetSharedVariable", "[", "n", "]"}], ";", "\n", "\t", 
      RowBox[{"n", " ", "=", " ", "0"}], ";", "\n", "\n", "\t", 
      RowBox[{"ntable", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"box", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}], " ", "\[LessEqual]", 
               " ", 
               RowBox[{
                RowBox[{"pointst", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", "  ", 
               RowBox[{"box", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "  ", "\[And]", " ", 
              RowBox[{
               RowBox[{"box", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "3"}], "]"}], "]"}], " ", "\[LessEqual]", 
               "  ", 
               RowBox[{
                RowBox[{"pointst", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", "  ", 
               RowBox[{"box", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "4"}], "]"}], "]"}]}]}], ",", " ", 
             RowBox[{
              RowBox[{"n", "=", 
               RowBox[{"n", "+", "1"}]}], ";", " ", 
              RowBox[{"i", "=", 
               RowBox[{
                RowBox[{"Length", "[", "points", "]"}], "+", "1"}]}]}], " ", 
             ",", 
             RowBox[{"n", "=", "n"}]}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "pointst", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "box", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
       "\t", "n"}]}], "\n", "\n", "]"}]}], " "}], "\n", 
 RowBox[{
  RowBox[{"boxcheck", "[", 
   RowBox[{"box_", ",", "points_"}], "]"}], ":=", 
  RowBox[{"Block", "[", " ", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"xmin", " ", "=", " ", 
       RowBox[{"box", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "  ", 
      RowBox[{"xmax", " ", "=", " ", 
       RowBox[{"box", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "  ", 
      RowBox[{"ymin", " ", "=", " ", 
       RowBox[{"box", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", "  ", 
      RowBox[{"ymax", " ", "=", " ", 
       RowBox[{"box", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ",", "  ", 
      RowBox[{"n", " ", "=", " ", "0"}], ",", " ", "output", ",", " ", "i"}], 
     "}"}], ",", "\n", "  ", "\n", "  ", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "points", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\n", "      ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "\[LessEqual]", "  ", 
           "xmax"}], " ", "\[And]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "\[GreaterEqual]", "  ", 
           "xmin"}], " ", "\[And]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "\[LessEqual]", "  ", 
           "ymax"}], " ", "\[And]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "\[GreaterEqual]", "  ", 
           "ymin"}]}], ",", "\n", "           ", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"n", "+", "1"}]}], ";", " ", 
          RowBox[{"i", "=", 
           RowBox[{
            RowBox[{"Length", "[", "points", "]"}], "+", "1"}]}]}], ",", 
         RowBox[{"n", "=", "n"}]}], " ", "\n", "           ", "]"}]}], "\n", 
      "      ", "]"}], ";", "\n", "  ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", " ", ">", " ", "0"}], ",", " ", 
       RowBox[{"n", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"n", " ", "=", " ", "0"}]}], "]"}], ";", "\n", "  ", "n"}]}], 
   "\n", "]"}]}]}], "Code",
 CellChangeTimes->{{3.7234887096312227`*^9, 3.7234887111056256`*^9}, {
  3.723490240420141*^9, 3.72349025259018*^9}, {3.723490374732992*^9, 
  3.723490382008821*^9}, {3.723490484862952*^9, 3.723490533501113*^9}, {
  3.723490573207445*^9, 3.723490759250038*^9}, {3.723490874192609*^9, 
  3.7234908914344664`*^9}, {3.723491153872797*^9, 3.723491253474661*^9}, {
  3.7234912968820753`*^9, 3.7234913211782017`*^9}, {3.7234919429086733`*^9, 
  3.723491946027852*^9}, {3.759270340216601*^9, 
  3.7592704220242524`*^9}},ExpressionUUID->"5699d5a6-8386-41ea-b168-\
c168950fdd17"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation", "Section",
 CellChangeTimes->{{3.7341073430773535`*^9, 3.734107355525233*^9}, {
  3.734107405669718*^9, 
  3.734107406388983*^9}},ExpressionUUID->"7359d443-a555-4a50-96c8-\
7a10bcfe6bf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"runSimulation", "[", 
    RowBox[{
    "it_", ",", "prec_", ",", "fV_", ",", "Vparam_", ",", "sradius_", ",", 
     "slength_", ",", " ", "k_", ",", " ", "w_", ",", " ", "dtfrac_", ",", 
     "snkfrac_", ",", "srcfrac_", ",", "RK2impit_", ",", "tsteps_"}], "]"}], ":=",
    " ", 
   RowBox[{"Block", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "coords", ",", "delta", ",", "lap", ",", " ", "srcindex", ",", " ", 
       "snkindex", ",", " ", "V", ",", " ", "\[Psi]0", ",", "t", ",", 
       "sinkend", ",", "snkendindex", ",", "dt", ",", " ", "sum", ",", 
       "\[Psi]", ",", "r", ",", " ", "\[Psi]2", ",", "name", ",", "dir", ",", 
       "tt", ",", "anim", ",", "lapnam", ",", "zeropoints", ",", "norm", ",", 
       "srcbegindex", ",", " ", "srcbeg", ",", "dirout", ",", "incount", ",", 
       "outcount", ",", "srcendindex", ",", "srcend", ",", "H", ",", "dat", 
       ",", "rt", ",", "snkbegindex", ",", "snkbeg"}], "}"}], ",", "\n", "\n",
      "\t", 
     RowBox[{
      RowBox[{"tt", " ", "=", " ", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\n", "\t", 
      RowBox[{"name", " ", "=", " ", 
       RowBox[{"StringJoin", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"ToString", "[", "sradius", "]"}], ",", "\"\<_\>\"", ",", 
         RowBox[{"ToString", "[", "slength", "]"}], ",", "\n", "\t\t\t\t", 
         "\"\<rl_\>\"", ",", 
         RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<_\>\"", ",", 
         RowBox[{"ToString", "[", "w", "]"}], ",", "\"\<kw_\>\"", ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"ToString", "[", 
          RowBox[{"Vparam", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\n", "\t\t\t\t", 
         "\"\<AVy_\>\"", ",", "\n", "\t\t\t\t", 
         RowBox[{"ToString", "[", "RK2impit", "]"}], ",", "\n", "\t\t\t\t", 
         "\"\<_\>\""}], "\n", "\t\t", "]"}]}], ";", "\n", "\t", 
      RowBox[{"anim", " ", "=", " ", 
       RowBox[{"StringJoin", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"ToString", "[", "sradius", "]"}], ",", "\"\<_\>\"", ",", 
         RowBox[{"ToString", "[", "slength", "]"}], ",", "\n", "\t\t\t", 
         "\"\<rl_\>\"", ",", 
         RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<_\>\"", ",", 
         RowBox[{"ToString", "[", "w", "]"}], ",", "\"\<kw_\>\"", ",", "\n", 
         "\t\t\t", 
         RowBox[{"ToString", "[", 
          RowBox[{"Vparam", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<AVy_\>\"", ",", 
         " ", 
         RowBox[{"ToString", "[", "RK2impit", "]"}], ",", "\"\<_\>\"", ",", 
         RowBox[{"ToString", "[", "tsteps", "]"}], ",", "\n", "\t\t\t", 
         "\"\<anim.avi\>\""}], "\n", "\t\t", "]"}]}], ";", "\n", "\t", 
      RowBox[{"dir", " ", "=", " ", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<C:\\\\mat\\\\\>\"", ",", 
         RowBox[{"ToString", "[", "it", "]"}], ",", "\"\<\\\\\>\"", ",", 
         RowBox[{"ToString", "[", "prec", "]"}], ",", 
         "\"\<Vert\\\\Vramp2\>\""}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"lapnam", " ", "=", " ", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "sradius", "]"}], ",", "\"\<_\>\"", ",", 
         RowBox[{"ToString", "[", "slength", "]"}], ",", "\"\<_lap.m\>\""}], 
        "]"}]}], ";", "\n", "\n", "\t", 
      RowBox[{"dirout", " ", "=", " ", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"dir", ",", "\"\<\\\\\>\"", ",", 
         RowBox[{"ToString", "[", "sradius", "]"}], ",", "\"\<_\>\"", ",", 
         RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<_\>\"", ",", 
         RowBox[{"ToString", "[", "w", "]"}], ",", "\"\<kw_\>\"", ",", "\n", 
         "\t", 
         RowBox[{"ToString", "[", 
          RowBox[{"Vparam", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<AVy_\>\""}], 
        "]"}]}], ";", "\n", "\n", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DirectoryQ", "[", "dir", "]"}], "\[Equal]", " ", "False"}], 
        ",", " ", 
        RowBox[{"CreateDirectory", "[", "dir", "]"}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"SetDirectory", "[", "dir", "]"}], ";", "\n", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FileExistsQ", "[", "name", "]"}], "\[Equal]", "True"}], ",",
         "\n", "\t\t ", 
        RowBox[{"Return", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<Warning: Duplicate file detected: \>\"", ",", "name"}],
           "]"}], "]"}], ",", "\n", "\t\t ", 
        RowBox[{
         RowBox[{"coords", " ", "=", " ", 
          RowBox[{"coordinateConstructionVert", "[", 
           RowBox[{"it", ",", "prec", ",", "sradius", ",", "slength"}], 
           "]"}]}], ";", "\n", "\t     ", 
         RowBox[{"delta", " ", "=", " ", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"coords", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ";", "\n", "\t\t", 
         RowBox[{"zeropoints", " ", "=", " ", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"coords", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"coords", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"coords", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FileExistsQ", "[", "lapnam", "]"}], "\[Equal]", "True"}],
            ",", "\n", "\t\t\t", 
           RowBox[{"lap", " ", "=", " ", 
            RowBox[{"Import", "[", "lapnam", "]"}]}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"lap", " ", "=", " ", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], " ", "*", " ", 
               RowBox[{
                RowBox[{"hamiltonianarray", "[", 
                 RowBox[{"coords", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", 
                RowBox[{"delta", "^", "2"}]}]}], "]"}]}], ";", "\n", "\t\t\t", 
            RowBox[{"Export", "[", 
             RowBox[{"lapnam", ",", "lap"}], "]"}], ";"}]}], "\n", "\t\t", 
          "]"}], ";", "\n", "\n", "\t\t", 
         RowBox[{"srcindex", " ", "=", " ", 
          RowBox[{"getindexposition", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"coords", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"snkindex", " ", "=", " ", 
          RowBox[{"getindexposition", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"coords", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";", "\n", "\n", 
         "\t\t", 
         RowBox[{"sinkend", " ", "=", " ", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "6", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_", ",", "y_"}], "}"}], "/;", " ", 
             RowBox[{"y", "\[GreaterEqual]", " ", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"coords", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"snkfrac", "*", "slength"}]}], ")"}]}]}]}]}], 
           "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"snkendindex", " ", "=", " ", 
          RowBox[{"getindexposition", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "sinkend"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"srcbeg", " ", "=", " ", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_", ",", "y_"}], "}"}], "/;", " ", 
             RowBox[{"y", "\[LessEqual]", "   ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"coords", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"srcfrac", "*", "slength"}]}], ")"}]}]}]}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"srcend", " ", "=", " ", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", "srcbeg"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"snkbeg", " ", "=", " ", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "6", "]"}], "]"}], ",", "sinkend"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"srcbegindex", " ", "=", " ", 
          RowBox[{"getindexposition", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "srcbeg"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"srcendindex", " ", "=", " ", 
          RowBox[{"getindexposition", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "srcend"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"snkbegindex", " ", "=", " ", 
          RowBox[{"getindexposition", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "snkbeg"}], "]"}]}], ";", 
         "\n", "\n", "\t\t", 
         RowBox[{"t", " ", "=", " ", "0"}], ";", "\n", "\n", "\t\t", 
         RowBox[{"\[Psi]0", " ", "=", " ", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"coords", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
            RowBox[{"N", "[", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "/", 
                   RowBox[{"coords", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "-", 
                 RowBox[{"w", "*", "t"}]}], ")"}]}], "]"}], "]"}]}], ",", 
           "\n", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", "srcbegindex"}], "}"}]}], "\n", "\t\t", "]"}], 
         ";", "\n", "\n", "\t", 
         RowBox[{"norm", " ", "=", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"\[Psi]0", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "\[Psi]0", "]"}]}], "}"}]}], "]"}], 
           "]"}]}], ";", "\n", "\t", 
         RowBox[{"dt", " ", "=", " ", 
          RowBox[{"dtfrac", "*", 
           RowBox[{"delta", "^", "2"}]}]}], ";", "\n", "\t", 
         RowBox[{"tt", " ", "=", " ", 
          RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
         RowBox[{"\[Psi]", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "norm"}], ")"}], "*", "\[Psi]0"}]}], ";", "\n", 
         "\t", 
         RowBox[{"sum", " ", "=", " ", "\[Psi]"}], ";", " ", "\n", "\t", 
         RowBox[{"V", " ", "=", " ", 
          RowBox[{"potRampY2", "[", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "Vparam", ",", 
            RowBox[{"coords", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"H", " ", "=", " ", 
          RowBox[{"lap", " ", "+", " ", "V"}]}], ";", "\n", "\n", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DirectoryQ", "[", "dirout", "]"}], "\[Equal]", "False"}],
            ",", "\n", "\t\t", 
           RowBox[{"CreateDirectory", "[", "dirout", "]"}]}], "\n", "\t", 
          "]"}], ";", "\n", "\t", 
         RowBox[{"SetDirectory", "[", "dirout", "]"}], ";", "\n", "\n", "\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rt", ",", 
            RowBox[{"{", 
             RowBox[{"dat", ",", "\[Psi]2"}], "}"}]}], "}"}], " ", "=", " ", 
          RowBox[{"Reap", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Do", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"(*", 
              RowBox[{
              "Do", " ", "MatrixExp", " ", "to", " ", "simulate", " ", "next",
                " ", "step", " ", "in", " ", "time"}], "*)"}], "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Psi]", " ", "=", " ", 
                RowBox[{"MatrixExp", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "I"}], "*", "H", "*", "dt"}], ",", "\[Psi]"}],
                  "]"}]}], ";", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"sum", "+=", " ", "\[Psi]"}], ";", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"t", " ", "=", " ", 
                RowBox[{"t", " ", "+", " ", "dt"}]}], ";", "\n", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                 "Set", " ", "the", " ", "source", " ", "to", " ", "the", " ",
                   "next", " ", "stage", " ", "in", " ", "the", " ", 
                  "planewave", " ", "and", " ", "sink", " ", "to", " ", "be", 
                  " ", "zero", " ", "to", " ", "remove", " ", "density"}], 
                 ",", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                 "this", " ", "is", " ", "to", " ", "prevent", " ", 
                  "reflections"}]}], " ", "*)"}], "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"\[Psi]", "[", 
                 RowBox[{"[", "srcbegindex", "]"}], "]"}], "=", " ", 
                RowBox[{"ParallelTable", "[", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "norm"}], ")"}], "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k", "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "/", 
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "-", 
                    RowBox[{"w", "*", "t"}]}], ")"}]}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "srcbegindex"}], "}"}]}], "]"}]}], ";", 
               "\n", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"r", " ", "=", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ParallelSum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"\[Psi]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "srcendindex"}], "}"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CoarsestGrained\>\""}]}], "]"}],
                   ",", 
                  RowBox[{"ParallelSum", "[", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Psi]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "snkendindex"}], "}"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CoarsestGrained\>\""}]}], "]"}],
                   ",", 
                  RowBox[{"ParallelSum", "[", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Psi]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "srcbegindex"}], "}"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CoarsestGrained\>\""}]}], "]"}],
                   ",", 
                  RowBox[{"ParallelSum", "[", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Psi]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "snkbegindex"}], "}"}], ",", 
                    RowBox[{
                    "Method", "\[Rule]", "\"\<CoarsestGrained\>\""}]}], 
                   "]"}]}], "}"}]}], ";", "\n", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Psi]", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "=", " ", "0"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "snkendindex"}], "}"}]}], "]"}], ";", 
               "\n", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Sow", "[", 
                RowBox[{"r", ",", "x"}], "]"}], ";", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Sow", "[", 
                RowBox[{"\[Psi]", ",", "y"}], "]"}]}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "tsteps"}], "}"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}], ";"}], "\n", "\t\t\t\t\t", "]"}]}], ";", 
         "\n", "\n", "\t\t\t", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "tsteps", "]"}], ",", "\"\<s.m\>\""}], 
            "]"}], ",", "dat"}], "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "tsteps", "]"}], ",", "\"\<.m\>\""}], 
            "]"}], ",", "\[Psi]2"}], "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"Export", "[", 
          RowBox[{"\"\<rest.m\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"coords", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "zeropoints"}], "}"}]}], 
          "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"sum", " ", "=", " ", 
          RowBox[{"sum", "/", 
           RowBox[{"(", 
            RowBox[{"tsteps", "+", "1"}], ")"}]}]}], ";", "\n", "\t\t", 
         RowBox[{"Export", "[", "\n", "\t\t\t", 
          RowBox[{"\"\<average.PNG\>\"", ",", "\n", "\t\t\t", 
           RowBox[{"ListDensityPlot", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"sum", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ")"}], "^", 
                    "2"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
               ",", "zeropoints"}], "]"}], ",", "\n", "\t\t\t\t", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
             RowBox[{"Frame", "\[Rule]", "False"}], ",", " ", 
             RowBox[{"ColorFunction", "\[Rule]", "\"\<FuchsiaTones\>\""}]}], 
            " ", "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}], ";", "\n", 
         "\t\t", 
         RowBox[{"Export", "[", 
          RowBox[{"\"\<sum.m\>\"", ",", "sum"}], "]"}]}]}], "\n", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{"end", " ", "if"}], "*)"}], "\n", "\t", "]"}], ";", "\n", " ",
       "\n", " ", "\n", "\t", 
      RowBox[{"tt", " ", "=", " ", 
       RowBox[{
        RowBox[{"AbsoluteTime", "[", "]"}], "-", "tt"}]}], ";", "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"name", ",", "tt", ",", "dat"}], "}"}]}]}], "\n", "]"}]}], 
  "\n"}]], "Code",
 CellChangeTimes->{{3.734692205696328*^9, 3.734692291378191*^9}, {
   3.734692357570304*^9, 3.734692370050637*^9}, {3.7346925769778547`*^9, 
   3.7346925998420463`*^9}, {3.734692650483365*^9, 3.7346928842112246`*^9}, {
   3.73469292477168*^9, 3.7346929977306976`*^9}, {3.734693070167224*^9, 
   3.7346931340513644`*^9}, {3.7346931642434583`*^9, 
   3.7346931806592374`*^9}, {3.7346933208033495`*^9, 
   3.7346933264677734`*^9}, {3.7346933608028092`*^9, 
   3.7346933661632366`*^9}, {3.7346954533302774`*^9, 3.73469560870673*^9}, {
   3.734695665713971*^9, 3.7346956824052467`*^9}, {3.73469588961946*^9, 
   3.734695943906227*^9}, {3.734695998275494*^9, 3.7346961154129105`*^9}, {
   3.7346961472819815`*^9, 3.7346961668027163`*^9}, {3.7346962160195503`*^9, 
   3.7346962171725354`*^9}, {3.7346962823386536`*^9, 
   3.7346963578166313`*^9}, {3.7346963978430905`*^9, 
   3.7346965177464676`*^9}, {3.7346965505000243`*^9, 
   3.7346966267094936`*^9}, {3.734696792531748*^9, 3.7346968704847*^9}, {
   3.734703704894744*^9, 3.73470371918305*^9}, {3.734703848461837*^9, 
   3.734703897055702*^9}, {3.734703934359713*^9, 3.7347043756953535`*^9}, {
   3.7347044168973017`*^9, 3.7347044209922466`*^9}, {3.734704564034328*^9, 
   3.734704721966709*^9}, {3.7347047555037575`*^9, 3.734704778897444*^9}, {
   3.7347049623849792`*^9, 3.7347053424818716`*^9}, {3.7347054325971594`*^9, 
   3.734705437172098*^9}, {3.7347056440993147`*^9, 3.734705692369164*^9}, {
   3.7347110662592063`*^9, 3.734711068306679*^9}, {3.734711440160718*^9, 
   3.734711445553146*^9}, {3.7347224293846445`*^9, 3.7347224836554165`*^9}, {
   3.734722516792431*^9, 3.7347225356391497`*^9}, {3.734722591782313*^9, 
   3.7347226824377584`*^9}, {3.7347234151653013`*^9, 
   3.7347234170668464`*^9}, {3.734723736573964*^9, 3.734723743277204*^9}, {
   3.7347237857569923`*^9, 3.7347237902529325`*^9}, 3.7347238378864565`*^9, {
   3.7347238846366167`*^9, 3.7347239355960407`*^9}, {3.7347239799490895`*^9, 
   3.734724039212972*^9}, {3.734724136477558*^9, 3.7347241394365187`*^9}, {
   3.7347262802687135`*^9, 3.73472628887694*^9}, {3.7347264065895977`*^9, 
   3.7347264165727024`*^9}, {3.7347267551175585`*^9, 3.734726844115758*^9}, {
   3.734727459055173*^9, 3.7347274690046186`*^9}, {3.7347275836762214`*^9, 
   3.7347275873568754`*^9}, {3.734728117665573*^9, 3.7347281189570484`*^9}, {
   3.7347290429584937`*^9, 3.7347290437750106`*^9}, {3.73472920095826*^9, 
   3.7347292932442555`*^9}, {3.73472949270345*^9, 3.7347295236601706`*^9}, {
   3.734731546781329*^9, 3.7347315732932186`*^9}, {3.734733447628894*^9, 
   3.734733452031292*^9}, {3.734863267040267*^9, 3.734863369406741*^9}, {
   3.7348634303508463`*^9, 3.7348634345432625`*^9}, {3.734864462992419*^9, 
   3.734864486479042*^9}, {3.7348645389438734`*^9, 3.7348647529931097`*^9}, {
   3.734864785350047*^9, 3.734864793521448*^9}, {3.7348648347849665`*^9, 
   3.734865023601761*^9}, {3.7348651783897543`*^9, 3.7348651803077245`*^9}, {
   3.7348652615065255`*^9, 3.734865272395314*^9}, {3.7348653490427675`*^9, 
   3.734865409141513*^9}, {3.734865447315827*^9, 3.7348654974566126`*^9}, {
   3.7348655330387363`*^9, 3.734865737952688*^9}, {3.734865776559748*^9, 
   3.734865801471464*^9}, {3.7348658343441567`*^9, 3.7348660015831175`*^9}, {
   3.7348660498879337`*^9, 3.7348661182896357`*^9}, {3.7348663609460907`*^9, 
   3.734866484255992*^9}, {3.7348669167231865`*^9, 3.7348669575821896`*^9}, {
   3.734867486193187*^9, 3.7348675433435698`*^9}, {3.734869621499945*^9, 
   3.734869629036196*^9}, {3.7348697061865273`*^9, 3.7348697072410183`*^9}, {
   3.734870198076911*^9, 3.7348702081382484`*^9}, {3.734873114067334*^9, 
   3.7348731254085026`*^9}, {3.7348892759121776`*^9, 
   3.7348892795986423`*^9}, {3.734889311226427*^9, 3.7348893139542084`*^9}, {
   3.73488950455279*^9, 3.7348895119929376`*^9}, 3.7348896552381086`*^9, {
   3.73488971674256*^9, 3.734889734054795*^9}, {3.7348910505231028`*^9, 
   3.7348910579401555`*^9}, {3.7348914553167224`*^9, 
   3.7348915621613464`*^9}, {3.734891606608773*^9, 3.734891624277151*^9}, {
   3.7348917257667274`*^9, 3.7348917482721443`*^9}, {3.734892043626628*^9, 
   3.7348920481673555`*^9}, {3.7348922026934824`*^9, 3.73489220338233*^9}, {
   3.7348923306102424`*^9, 3.7348923802428513`*^9}, {3.7348971240312915`*^9, 
   3.734897138366177*^9}, {3.7348985906663437`*^9, 3.7348985915583487`*^9}, {
   3.7348987513146224`*^9, 3.7348987520630054`*^9}, 3.7348988784033923`*^9, {
   3.7348989515755496`*^9, 3.7348989611377296`*^9}, {3.7348990514615*^9, 
   3.7348990921819324`*^9}, {3.734899125893613*^9, 3.7348993226467686`*^9}, 
   3.734905746481964*^9, {3.7349387428070483`*^9, 3.734938764964305*^9}, 
   3.7349927130983047`*^9, {3.734995921333852*^9, 3.734996012009592*^9}, 
   3.7349960624902706`*^9, {3.7349961562439957`*^9, 3.7349961956384354`*^9}, {
   3.7349962418952246`*^9, 3.7349962568860283`*^9}, {3.7350317736927614`*^9, 
   3.735031800941899*^9}, {3.735031912655775*^9, 3.7350319351645174`*^9}, 
   3.7350322323192735`*^9, {3.735035339947193*^9, 3.7350353428593364`*^9}, {
   3.7350353993396497`*^9, 3.7350354277688203`*^9}, {3.735036183799135*^9, 
   3.7350362035270386`*^9}, {3.735036537864213*^9, 3.7350365423910913`*^9}, {
   3.7350366369997983`*^9, 3.735036668067356*^9}, {3.7350367153839965`*^9, 
   3.7350367282624984`*^9}, {3.759271692927209*^9, 3.7592721612156916`*^9}, {
   3.759272221503696*^9, 
   3.7592723593922544`*^9}},ExpressionUUID->"064753ea-007d-4ebf-b355-\
0397072f70d4"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
TaggingRules->{"Salvaged" -> True},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 288, 4, 96, "Title",ExpressionUUID->"aab7f7e7-f586-4645-bcaa-4d6482fc51a9"],
Cell[CellGroupData[{
Cell[893, 30, 166, 3, 67, "Section",ExpressionUUID->"2e9a604f-b5ad-4b4d-99ae-08f3adb58abf"],
Cell[1062, 35, 707, 13, 78, "Text",ExpressionUUID->"dc07cbbf-84cc-4c0e-ad08-3c2f2d611110"],
Cell[CellGroupData[{
Cell[1794, 52, 172, 3, 44, "Subsubsection",ExpressionUUID->"00440248-e6f5-4915-8bb8-d489ea89a9a9"],
Cell[1969, 57, 387, 8, 34, "Text",ExpressionUUID->"51d2a2a2-5c37-4669-83b4-f57327c36e52"],
Cell[2359, 67, 8170, 181, 897, "Code",ExpressionUUID->"0bc09b9d-58e9-4a5b-8462-e3b492341599"],
Cell[10532, 250, 322, 7, 34, "Text",ExpressionUUID->"ecc8ab1d-d56a-4c17-95db-a996317d3f1d"],
Cell[10857, 259, 5499, 127, 195, "Code",ExpressionUUID->"f511c3cf-eaf5-48ac-84dd-8c6bcd35a2c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16393, 391, 228, 5, 44, "Subsubsection",ExpressionUUID->"18c9c9a5-5541-476b-bb85-39af4780b555"],
Cell[16624, 398, 2457, 66, 86, "Text",ExpressionUUID->"46f2368c-9e8e-449f-8f4e-9db1b28125bd"],
Cell[19084, 466, 5167, 137, 339, "Code",ExpressionUUID->"73f0dedb-91b9-4b4e-a535-50baa71bfd29"],
Cell[24254, 605, 395, 8, 34, "Text",ExpressionUUID->"77c51165-2198-44ec-83bf-0dda4d2c3c60"],
Cell[24652, 615, 4819, 134, 267, "Code",ExpressionUUID->"990bbd6e-a717-468f-ad99-bd744409f6e0"],
Cell[29474, 751, 248, 6, 34, "Text",ExpressionUUID->"f2912582-c8ee-491e-be15-56f80de471cb"],
Cell[29725, 759, 10790, 262, 681, "Code",ExpressionUUID->"cf9849af-a726-46bf-a764-85c30d8a1806"],
Cell[40518, 1023, 327, 7, 34, "Text",ExpressionUUID->"4ef67800-a32f-486a-a19d-0c58c5d648c6"],
Cell[40848, 1032, 1706, 45, 141, "Code",ExpressionUUID->"07ae14c0-3a4e-44ec-860e-10fb0d844c22"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42591, 1082, 238, 4, 44, "Subsubsection",ExpressionUUID->"3a185e54-e886-4993-b88c-452ebf6655f9"],
Cell[42832, 1088, 765, 13, 78, "Text",ExpressionUUID->"3e3fe2aa-7e10-4c91-bc5e-59556ed49cad"],
Cell[43600, 1103, 17313, 420, 969, "Code",ExpressionUUID->"51d9c60c-5616-4277-a298-95d1b2a4aeaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60950, 1528, 268, 4, 53, "Subsection",ExpressionUUID->"260799f4-9169-4a02-a943-18e97ca38163"],
Cell[61221, 1534, 1163, 21, 78, "Text",ExpressionUUID->"6b7be7fc-fffe-4cc2-ac62-fe364051dae9"],
Cell[62387, 1557, 16067, 403, 1692, "Code",ExpressionUUID->"7fabe12d-6935-4933-aa30-eec0b80076e0"],
Cell[78457, 1962, 152, 3, 28, "Input",ExpressionUUID->"e0744fd4-4856-4973-83cb-8830599d013d"],
Cell[CellGroupData[{
Cell[78634, 1969, 223, 4, 44, "Subsubsection",ExpressionUUID->"fdafc1ff-53d8-45e7-96d8-19920399a538"],
Cell[78860, 1975, 682, 11, 56, "Text",ExpressionUUID->"ef5c5db6-57e3-4d27-8abf-ddcca586569b"],
Cell[79545, 1988, 6734, 175, 447, "Code",ExpressionUUID->"3bc08337-22e9-4e44-a35e-5ee227165d7a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86328, 2169, 199, 3, 53, "Subsection",ExpressionUUID->"2dabc08f-5dfc-4b2f-8306-036a472e28d5"],
Cell[86530, 2174, 451, 9, 56, "Text",ExpressionUUID->"a883d915-0893-498e-b7d2-ede138730f4d"],
Cell[86984, 2185, 2890, 82, 110, "Code",ExpressionUUID->"a9216b01-6504-4af1-8f6b-8a04af8ab287"],
Cell[89877, 2269, 2622, 74, 177, "Code",ExpressionUUID->"ec8b480e-7721-4947-8099-7f4e08ba623b"],
Cell[92502, 2345, 131, 3, 28, "Input",ExpressionUUID->"92713a44-f2b2-46fb-b1b3-4e9fab8b08fc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92682, 2354, 173, 3, 67, "Section",ExpressionUUID->"a768d014-a797-4b7d-bd27-fe50b6ac7db4"],
Cell[92858, 2359, 29333, 725, 1905, "Code",ExpressionUUID->"c69d9a10-c59a-4aca-8b28-0326f270d6d5"],
Cell[122194, 3086, 152, 3, 28, "Input",ExpressionUUID->"23d56460-92d9-493c-9897-c5c4df854cda"],
Cell[122349, 3091, 205, 4, 28, "Input",ExpressionUUID->"c3660a23-885d-492b-bb4b-904ea76aad24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122591, 3100, 190, 3, 67, "Section",ExpressionUUID->"d69df91c-a67b-43f3-83dc-e75601fc191f"],
Cell[122784, 3105, 40380, 927, 2643, "Code",ExpressionUUID->"0272427a-4029-4972-8c19-e4b35dd18f0f"],
Cell[163167, 4034, 7110, 178, 501, "Code",ExpressionUUID->"5699d5a6-8386-41ea-b168-c168950fdd17"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170314, 4217, 206, 4, 67, "Section",ExpressionUUID->"7359d443-a555-4a50-96c8-7a10bcfe6bf8"],
Cell[170523, 4223, 27754, 578, 2103, "Code",ExpressionUUID->"064753ea-007d-4ebf-b355-0397072f70d4"]
}, Open  ]]
}, Open  ]]
}
]
*)

